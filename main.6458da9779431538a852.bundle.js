(()=>{"use strict";var t,e={960:(t,e,s)=>{s.d(e,{r:()=>J});var a=s(260),i=s.n(a);const n=720,o=1080,h="rgb(240, 240, 240)",r="PlayScene",l=180;class c extends Phaser.Scene{constructor(){super({key:"PreloadScene"})}preload(){J.getSceneManager().stateMachine.setState("preload",this),this.showProgress(),this.preloadButtons(),this.preloadBalls(),this.preloadThemes(),this.preloadSprites(),this.preloadAudio()}create(){J.getSceneManager().stateMachine.setState("start",this)}showProgress(){const t=this.add.graphics();t.fillStyle(16777215,1);const e=t.fillRect(360,540,0,30),s=this.add.text(360,525,"0%",{fontFamily:"MilkyHoney",fontSize:"40px",color:"#ababab"});s.setOrigin();const a=this.add.text(360,560,"0%",{fontFamily:"MilkyHoney",fontSize:"25px",color:"#ababab"});a.setOrigin(),this.load.on("progress",(function(t){e.fillRect(235,590,250*t,30),s.setText(Math.floor(100*t)+"%")})),this.load.on("fileprogress",(function(t){a.setText("Loading "+t.type+": "+t.key+" "+(t.bytesTotal/1024).toFixed(2)+"KB")})),this.load.on("complete",(()=>{t.destroy(),s.destroy(),a.destroy(),e.destroy()}))}preloadButtons(){this.load.setPath("assets/images/buttons/"),this.load.image("close","Close.png"),this.load.image("close","Divide.png"),this.load.image("close","Facebook.png"),this.load.image("f-left","ForwardLeft.png"),this.load.image("f-right","ForwardRight.png"),this.load.image("game-pad","GamePad.png"),this.load.image("google","Google.png"),this.load.image("heart","Heart.png"),this.load.image("home","Home.png"),this.load.image("ig","Instagram.png"),this.load.image("ad","ad.png"),this.load.image("return","return.png"),this.load.image("trophy","Trophy.png"),this.load.image("trash","Trash.png"),this.load.image("sound-on","sound-on.png"),this.load.image("sound-off","sound-off.png"),this.load.image("light-on","light-on.png"),this.load.image("light-off","light-off.png"),this.load.image("shop","Shop.png"),this.load.image("share","Share.png"),this.load.image("settings","Settings.png"),this.load.image("right","Right.png"),this.load.image("retry","Retry.png"),this.load.image("question","Question.png"),this.load.image("pow-up","PowerUp.png"),this.load.image("left","Left.png"),this.load.image("menu","Menu.png"),this.load.image("msg","Message.png"),this.load.image("music","Music.png"),this.load.image("minus","Minus.png"),this.load.image("pause","Pause.png"),this.load.image("play","Play.png"),this.load.image("plus","Plus.png"),this.load.image("free-gift","FreeGift.png"),this.load.image("drag-it","DragIt.png"),this.load.image("customize","customize.png"),this.load.image("challenge","challenge.png"),this.load.image("leaderboard","Leaderboard.png"),this.load.image("leader-board","leader-board.png"),this.load.image("main-menu","mainmenu.png"),this.load.image("resume","resume.png"),this.load.image("lock","lock.png")}preloadBalls(){this.load.setPath("assets/images/colorful-balls/"),this.load.image("ball_1","1.png"),this.load.image("ball_2","2.png"),this.load.image("ball_3","3.png"),this.load.image("ball_4","4.png"),this.load.image("ball_5","5.png"),this.load.image("ball_6","6.png"),this.load.image("ball_7","7.png"),this.load.image("ball_8","8.png"),this.load.image("ball_9","9.png"),this.load.image("ball_10","10.png"),this.load.image("ball_11","11.png"),this.load.image("ball_12","12.png"),this.load.image("ball_locked","Locked.png")}preloadSprites(){this.load.setPath("assets/images/sprites/"),this.load.image("dot","Dot_0.png"),this.load.image("ball","ball.png"),this.load.image("hoop-down","hoop_1.png"),this.load.image("hoop-up","hoop_2.png"),this.load.image("basket","basket.png"),this.load.image("logo","logo.png"),this.load.image("net","net.png"),this.load.image("star","star.png"),this.load.image("shadow","shadow.png"),this.load.image("flare","flare.png"),this.load.image("spark","spark.png")}preloadThemes(){this.load.setPath("assets/images/theme-game-mode/"),this.load.image("bg_0","0/bg_0.png"),this.load.image("bg_1","1/bg_1.png"),this.load.image("bg_2","2/bg_2.png"),this.load.image("wall_0","0/wall_0.png"),this.load.image("wall_1","1/wall_1.png"),this.load.image("wall_2","2/wall_2.png"),this.load.image("theme_0","0.png"),this.load.image("theme_1","1.png"),this.load.image("theme_2","2.png"),this.load.image("theme_3","3.png"),this.load.image("theme_4","4.png"),this.load.image("check","check.png"),this.load.image("check","popup.png")}preloadAudio(){this.load.setPath("assets/audio/"),this.load.audio("bounce","Bounce.wav"),this.load.audio("click","Click.wav"),this.load.audio("game-over","GameOver.wav"),this.load.audio("net","Net.wav"),this.load.audio("shoot","Shoot.mp3")}}let d=0;class g{constructor(t,e){this.states=new Map,this.id=(++d).toString(),this.isChangingState=!1,this.id=null!=e?e:this.id,this.context=t,this.changeStateQueue=[]}addState(t,e){var s,a,i;const n=this.context;return this.states.set(t,{name:t,onEnter:null===(s=null==e?void 0:e.onEnter)||void 0===s?void 0:s.bind(n),onUpdate:null===(a=null==e?void 0:e.onUpdate)||void 0===a?void 0:a.bind(n),onExit:null===(i=null==e?void 0:e.onExit)||void 0===i?void 0:i.bind(n)}),this}setState(t,...e){var s,a;if(this.states.has(t)){if(this.isChangingState)return this.changeStateQueue.push(t),void console.log(`[StateMachine (${this.id})] change from ${null!==(a=null===(s=this.currentState)||void 0===s?void 0:s.name)&&void 0!==a?a:"none"} to ${t}`);this.isChangingState=!0,this.currentState&&this.currentState.onExit&&this.currentState.onExit(),this.currentState=this.states.get(t),this.currentState.onEnter&&this.currentState.onEnter(e),this.isChangingState=!1}else console.warn(`Tried to change to unknown state: ${t}`)}isCurrentState(t){return!!this.currentState&&this.currentState.name===t}update(t){this.changeStateQueue.length>0?this.setState(this.changeStateQueue.shift()):this.currentState&&this.currentState.onUpdate&&this.currentState.onUpdate(t)}}function u(t,e){return Math.floor(Math.random()*(e-t+1))+t}function p(){return Math.random()*Math.PI}function y(t,e){return t*Math.cos(e)}function S(t,e){return t*Math.sin(e)}function m(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}function b(t,e){return Math.atan2(e,t)}class x extends Phaser.Physics.Arcade.Sprite{constructor(t){super(t.scene,t.x,t.y,t.key),this.setOrigin(.5,.5),this.scale=t.scale?t.scale:1,this.setScale(t.scale),this.body=this.body}}class k extends x{constructor(t){var e;super(t),this.elapsed=0,this.isMoving=!1,this.powerUp=!1,this.scene.physics.add.existing(this),this.disableBody(!0,!0),null===(e=this.body)||void 0===e||e.setCircle(this.width/2),this.setBounce(.75,.75),this.setVisible(!0),this.setGravityY(980),this.setCollideWorldBounds(!1,1,1,!0),this.scene.add.existing(this),this.stateMachine=new g(this,"ball"),this.stateMachine.addState("idle",{onEnter:this.onIdleEnter}).addState("demo",{onUpdate:this.onDemoUpdate}).addState("snipe",{onEnter:this.onSnipeEnter,onExit:this.onSnipeExit}).addState("fly",{onEnter:this.onFlyEnter,onUpdate:this.onFlyUpdate}),this.stateMachine.setState("idle")}update(t){this.stateMachine.update(t)}onIdleEnter(t){if(t.length>0){const[e,s,a]=t;a&&a%5==0&&a>0&&0==this.powerUp&&(this.powerUp=!0),this.setX(e),this.setY(s),this.setVelocity(0,0),this.disableBody(!0,!1),this.isMoving=!1}}emitSmokeParticle(){this.smokeParticle=this.scene.add.particles(100,100,"dot",{color:[14819916,14833698,14858274,6908265,16119285],alpha:{start:.9,end:.1,ease:"sine.easeout"},angle:{min:0,max:360},rotate:{min:0,max:360},speed:{min:40,max:70},colorEase:"quad.easeinout",lifespan:1500,scale:.5,frequency:60}),this.smokeParticle.startFollow(this,-90,-120,!0),this.smokeParticle.start()}disableSmoke(){this.smokeParticle.stop()}onDemoUpdate(t){this.rotation+=.05;let e=this.elapsed/3500*t/16;const s=110+e*(2*(1-e)*90+470*e),a=900+e*(2*(1-e)*-900+-330*e);this.x=s,this.y=a,s>=580&&a>=570&&(e=0,this.elapsed=0),this.elapsed+=this.scene.game.loop.delta}onFlyEnter(t){var e;const[s,a]=t,i=-this.radian;if(this.speed>0){this.isMoving=!0;const t=7.5*Math.min(this.speed,l);this.enableBody(!0,s,a,!0,!0),this.setVelocity(y(t,i),S(t,i)),this.scene.physics.velocityFromRotation(i,t,null===(e=this.body)||void 0===e?void 0:e.velocity)}}onFlyUpdate(t){this.isMoving&&(this.rotation+=.1)}onSnipeEnter(t){[this.speed,this.radian]=t,this.trajectory=[],this.points=this.scene.add.graphics(),this.points.fillStyle(16753920,1);for(let t=0;t<6;t++){const e=.2*t;let s=this.x+y(7.5*Math.min(l,this.speed),this.radian)*e;const a=this.y-S(7.5*Math.min(l,this.speed),this.radian)*e+490*Math.pow(e,2);s<0?s=-s:s>n&&(s=n-(s-n)),this.trajectory.push({x:s,y:a})}for(let t=0;t<6;t++){const e=this.trajectory[t];this.points.fillCircle(e.x,e.y,12-t)}}onSnipeExit(){this.points.destroy()}isPowerUp(){return this.powerUp&&this.smokeParticle}disablePowerUp(){this.powerUp=!1}}class f extends Phaser.GameObjects.Container{constructor(t){super(t.scene,t.x,t.y),this.scaleRatio=t.scale,this.button=t.scene.add.sprite(0,0,t.key).setInteractive(),this.add(this.button),this.text=t.scene.add.text(0,0,t.text,{color:"#ffffff",fontSize:"27px",fontFamily:"Roboto",fontStyle:"bold"}),this.text.setOrigin(.5),this.add(this.text),this.callback=t.callback,t.scene.add.existing(this),this.button.on("pointerdown",this.onPointerDown,this),this.button.on("pointerup",this.onPointerUp,this),this.button.on("pointerout",this.onPointerOut,this),this.button.setScale(this.scaleRatio)}onPointerDown(){this.button.setScale(.9*this.scaleRatio)}onPointerUp(){this.button.setScale(this.scaleRatio),this.callback()}onPointerOut(){this.button.setScale(this.scaleRatio)}}class w extends Phaser.GameObjects.Image{constructor(t){super(t.scene,t.x,t.y,t.key,t.frame),this.scaleRatio=t.scale?t.scale:1,this.setScale(this.scaleRatio),t.scene.add.existing(this)}}class v extends w{constructor(t){super(t),this.setInteractive(),this.on("pointerdown",this.onPointerDown,this),this.on("pointerup",this.onPointerUp,this),this.on("pointerout",this.onPointerOut,this),this.setScale(this.scaleRatio),this.callback=t.callback}onPointerDown(){this.setScale(.9*this.scaleRatio)}onPointerUp(){this.setScale(this.scaleRatio),this.callback()}onPointerOut(){this.setScale(this.scaleRatio)}enableOscillator(){this.scene.tweens.add({targets:this,scaleX:.25,scaleY:.25,yoyo:!0,repeat:-1,duration:1e3,ease:"Quad.easeInOut"})}}class M extends Phaser.GameObjects.Text{constructor(t){super(t.scene,t.x,t.y,t.msg,t.style),this.setOrigin(.5),this.scene.add.existing(this)}emitTextFadeInOut(t,e,s){this.setX(t),this.setY(e),this.setAlpha(1),this.scene.tweens.add({targets:this,alpha:0,duration:1e3,ease:"ease.sineInOut",onComplete:()=>{this.setAlpha(0)}})}}class B extends v{constructor(t){super(t)}onPointerDown(){this.setScale(.9*this.scaleRatio),this.callback()}}class P extends Phaser.Scene{constructor(){super({key:"StartScene"})}create(t){this.cameras.main.fadeIn(500,0,0,0),new v({scene:this,x:50,y:50,key:"settings",callback:()=>{J.getSceneManager().stateMachine.setState("setting",this,{data:"start"})},scale:.2*1.5}),new v({scene:this,x:160,y:50,key:"leaderboard",callback:()=>{console.log("leaderboard")},scale:.36}),new w({scene:this,x:630,y:50,key:"star",scale:.48}),new M({scene:this,x:680,y:50,msg:localStorage.getItem("star")||"0",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}),new w({scene:this,x:360,y:370,key:"logo",scale:.48}),new B({scene:this,x:110,y:880,key:"basket",scale:.75,callback:()=>{this.firebase.getUser()?this.loadPlayScene(t):(this.firebase.signInWithPopup(),this.firebase.onLoggedIn((()=>{this.loadPlayScene(t)})))}}).setDepth(2),new w({scene:this,x:580,y:570,key:"basket",scale:.75}).setDepth(2),this.ball=new k({scene:this,x:110,y:900,key:"ball",scale:.2}).setDepth(1),t.skin?this.ball.setTexture(t.skin):this.ball.setTexture("ball"),this.ball.stateMachine.setState("demo"),new v({scene:this,x:100,y:990,key:"drag-it",callback:()=>{this.firebase.getUser()&&(this.cameras.main.fadeOut(500,0,0,0),this.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(()=>{t.skin?J.getSceneManager().stateMachine.setState("play",this,t):J.getSceneManager().stateMachine.setState("play",this,{skin:"ball"})})))},scale:.3*1.5}).enableOscillator(),new f({scene:this,x:530,y:890,key:"customize",text:"",scale:.2*1.5,callback:()=>{J.getSceneManager().stateMachine.setState("customize",this)}}),new f({scene:this,x:530,y:1020,key:"challenge",text:"",scale:.3*1.5,callback:()=>{console.log("challenge")}})}update(t,e){this.ball.update(e)}loadPlayScene(t){this.cameras.main.fadeOut(500,0,0,0),this.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(()=>{t.skin?J.getSceneManager().stateMachine.setState("play",this,t):J.getSceneManager().stateMachine.setState("play",this,{skin:"ball"})}))}}class E extends x{constructor(t){super(t),this.setInteractive(),this.scene.physics.add.existing(this),this.disableBody(!0,!0),this.setVisible(!0),this.scene.add.existing(this);const e=this.postFX.addGlow(16777215,0,0,!1,.1,24);this.scene.tweens.add({targets:e,outerStrength:7,yoyo:!0,loop:-1,ease:"sine.inout"}),this.scene.tweens.add({targets:this,scaleX:.25,scaleY:.25,yoyo:!0,loop:-1,ease:"sine.inout"})}}class O extends x{constructor(t){super(t),this.createMultiBody(),this.scene.physics.add.existing(this),this.disableBody(!0,!1),this.scene.add.existing(this),this.stateMachine=new g(this,"ball"),this.stateMachine.addState("idle",{onEnter:this.onIdleEnter}).addState("snipe",{onEnter:this.onSnipeEnter}).addState("transit",{onEnter:this.onTransitEnter}),this.stateMachine.setState("idle")}createMultiBody(){const t=40,e={allowGravity:!1,immovable:!0,visible:!1};this.bodyRects=[this.scene.add.rectangle(this.x-t,this.y,t,t),this.scene.add.rectangle(this.x,this.y,t,t),this.scene.add.rectangle(this.x+t,this.y,t,t)],this.edgeRects=[this.scene.add.rectangle(this.x-70,this.y-25,5,5),this.scene.add.rectangle(this.x+70,this.y-25,5,5)],this.openRects=[this.scene.add.rectangle(this.x-25,this.y-25,20,35),this.scene.add.rectangle(this.x+25,this.y-25,20,35)],this.bodyGroup=this.scene.physics.add.group(e),this.openGroup=this.scene.physics.add.group(e),this.edgeGroup=this.scene.physics.add.group(Object.assign(Object.assign({},e),{bounceX:.02,bounceY:.02})),this.bodyGroup.addMultiple(this.bodyRects),this.edgeGroup.addMultiple(this.edgeRects),this.openGroup.addMultiple(this.openRects)}updateBodyGroup(){const t=y(40,this.rotation),e=S(40,this.rotation);this.bodyGroup.setX(this.x-t,t),this.bodyGroup.setY(this.y-e,e)}updateEdgeGroup(){const t=b(this.width,this.height),e=m(this.width,this.height)*this.scale/2;this.edgeGroup.setX(this.x-y(e,-this.rotation-t),y(e,-this.rotation+t)+y(e,-this.rotation-t)),this.edgeGroup.setY(this.y+S(e,-this.rotation-t),-S(e,-this.rotation+t)-S(e,-this.rotation-t))}updateOpenGroup(){const t=b(this.width,this.height),e=m(this.width,this.height)*(this.scale-.1)/4;this.openGroup.setX(this.x-y(e,-this.rotation-t),y(e,-this.rotation+t)+y(e,-this.rotation-t)),this.openGroup.setY(this.y+S(e,-this.rotation-t),-S(e,-this.rotation+t)-S(e,-this.rotation-t))}transition(t,e,s,a,i){this.scene.tweens.add({targets:t,x:e,y:s,duration:1e3,ease:"Sine.easeInOut",onComplete:()=>{this.updateBodyGroup(),this.updateEdgeGroup(),a&&(this.updateOpenGroup(),1==i?this.addRotating():2==i?this.addMovingX():3==i&&this.addMovingY())}})}onTransitEnter(t){const[e,s]=[n,o],[a,i]=t,h=this.y>s/2?u(200,s/2-200):u(s/2,s-100);this.y=h,this.transition(this,this.x,h,1==a,i)}onIdleEnter(){this.clearEffect(),this.updateEdgeGroup(),this.setScale(this.scaleX,this.scaleX)}onSnipeEnter(t){const[e,s]=t;this.rotation=s-Math.PI/2,this.setScale(this.scaleX,Math.max(2*this.scaleX*Math.min(e,l)/l,this.scaleX)),this.updateEdgeGroup()}moveFollower(t){const[e,s]=[n,o];t instanceof k?(this.transition(t,this.x,this.y,!1),this.clearEffect()):t instanceof E&&(this.x>e/2?this.setRotation(-p()/2):this.setRotation(p()/2),this.transition(t,this.x+y(80,Math.PI/2-this.rotation),this.y-S(80,Math.PI/2-this.rotation),!1),t.setAlpha(1))}reset(){this.angle=0}vibrateX(){this.scene.tweens.add({targets:this,x:this.x-10,duration:20,ease:"Linear",yoyo:!0,repeat:3})}vibrateY(){this.scene.tweens.add({targets:this,y:this.x-10,duration:20,ease:"Linear",yoyo:!0,repeat:3})}addMovingX(){this.tweensX=this.scene.tweens.add({targets:this,x:this.x-25,duration:1e3,ease:"Power1",yoyo:!0,repeat:-1,onUpdate:()=>{this.updateBodyGroup(),this.updateEdgeGroup(),this.updateOpenGroup()}})}addMovingY(){this.tweensY=this.scene.tweens.add({targets:this,y:this.y+30,duration:1e3,ease:"Power1",yoyo:!0,repeat:-1,onUpdate:()=>{this.updateBodyGroup(),this.updateEdgeGroup(),this.updateOpenGroup()}})}addRotating(){this.tweensAngle=this.scene.tweens.add({targets:this,angle:Phaser.Math.Between(-45,45),duration:1e3,ease:"Linear",yoyo:!0,repeat:-1,onUpdate:()=>{this.updateBodyGroup(),this.updateEdgeGroup(),this.updateOpenGroup()}})}clearEffect(){this.tweensX&&this.tweensX.stop(),this.tweensY&&this.tweensY.stop(),this.tweensAngle&&this.tweensAngle.stop()}}class I extends Phaser.GameObjects.TileSprite{constructor(t){super(t.scene,t.x,t.y,t.w,t.h,t.key),this.scaleRatio=t.scale?t.scale:1,this.setScale(this.scaleRatio),t.scene.add.existing(this)}}class T extends Phaser.GameObjects.Text{constructor(t){super(t,320,20,"",{color:"#ffa500",fontSize:"28px",fontStyle:"bold"}),t.add.existing(this),this.setOrigin(0)}update(){this.setText(`fps: ${Math.floor(this.scene.game.loop.actualFps)}`)}}class G extends Phaser.Scene{constructor(){super({key:"PlayScene"})}create(t){J.getScoreManager().reset(),this.netAudio=this.sound.add("net"),this.shootAudio=this.sound.add("shoot"),this.clickAudio=this.sound.add("click"),this.gameOverAudio=this.sound.add("game-over"),this.createAssets(),this.createWall(),this.createObjects(t),this.createEventListeners()}update(t){var e,s;this.ball.update(t),this.updateBackground(),this.ball.y>o&&this.onHitLowerBound(),((null===(e=this.ball.body)||void 0===e?void 0:e.velocity.y)||0)>0&&this.physics.collide(this.ball,this.curBasket.bodyGroup)&&(null===(s=this.ball.body)||void 0===s?void 0:s.touching.down)&&this.onHitCurrentBasket(),this.physics.overlap(this.ball,this.nextBasket.openGroup)&&this.onHitNextBasket(),this.physics.collide(this.ball,this.nextBasket.bodyGroup)&&this.onHitObstacle()}onPointerDown(t){this.dragStart={x:t.x,y:t.y}}onPointerUp(t){this.dragStart&&(this.curBasket.stateMachine.setState("idle"),this.ball.stateMachine.setState("fly",this.curBasket.x,this.curBasket.y),this.dragStart=null,this.shootAudio.play())}onPointerMove(t){if(t.isDown&&this.dragStart){const[e,s]=function(t,e){const s=Phaser.Math.Angle.Between(t.x,t.y,e.x,e.y);return[Phaser.Math.Distance.Between(t.x,t.y,e.x,e.y),s]}(this.dragStart,t);this.curBasket.stateMachine.setState("snipe",e,s),this.ball.stateMachine.setState("snipe",e,Math.PI/2-this.curBasket.rotation)}}createAssets(){const[t,e]=[n,o];this.fps=new T(this),this.background=new I({scene:this,x:t/2,y:e/2,w:4096,h:4096,key:"wall_0",scale:.45}),new w({scene:this,x:t/2,y:25-e,key:"bg_1"}).setAlpha(.6),new w({scene:this,x:t/2,y:e/2,key:"bg_0"}).setAlpha(.6).setScale(.55),this.pauseImg=new v({scene:this,x:80,y:50,key:"pause",callback:()=>{J.getSceneManager().stateMachine.setState("pause",this)},scale:.12}),this.starImg=new w({scene:this,x:t-90,y:50,key:"star",scale:.32}),this.scoreText=new M({scene:this,x:t-40,y:50,msg:"0",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}),this.curScoreText=new M({scene:this,x:t/2,y:e/2-120,msg:J.getScoreManager().getCurScore().toString(),style:{fontSize:"150px",color:"#ababab",fontStyle:"bold"}}),this.perfectText=new M({scene:this,x:-100,y:-100,msg:"PERFECT!!",style:{fontSize:"25px",color:"#ffa500",fontStyle:"bold"}}),this.incScoreText=new M({scene:this,x:-100,y:-100,msg:"+1",style:{fontSize:"50px",color:"red",fontStyle:"bold"}})}createWall(){const[t,e]=[n,o],s=this.add.line(0,-5*e,0,-5*e,0,5*e),a=this.add.line(t,-5*e,t,-5*e,t,5*e),i=this.add.line(0,0,0,0,0,2*e),h=this.add.line(t,0,t,0,t,2*e);this.lineGroupUpperBounds=this.physics.add.group({allowGravity:!1,immovable:!0,visible:!0,bounceX:1,bounceY:1}),this.lineGroupUpperBounds.add(s),this.lineGroupUpperBounds.add(a),this.lineGroupBounds=this.physics.add.group({allowGravity:!1,immovable:!0,visible:!0,collideWorldBounds:!0,bounceX:1,bounceY:1}),this.lineGroupBounds.add(i),this.lineGroupBounds.add(h)}createObjects(t){this.star=new E({scene:this,x:630,y:50,key:"star",scale:.32}),this.curBasket=new O({scene:this,x:130,y:740,key:"basket",callback:(t,e,s,a)=>{this.ball.stateMachine.setState("fly",t,e,s,a)},scale:.65}).setDepth(2).setMaxVelocity(0,0),this.nextBasket=new O({scene:this,x:580,y:340,key:"basket",callback:(t,e,s,a)=>{this.ball.stateMachine.setState("fly",t,e,s,a)},scale:.65}).setDepth(2).setMaxVelocity(0,0),this.ball=new k({scene:this,x:125,y:740,key:"ball",scale:.12}).setDepth(1),t&&this.ball.setTexture(t.skin)}createEventListeners(){this.input.on("pointerdown",this.onPointerDown,this),this.input.on("pointermove",this.onPointerMove,this),this.input.on("pointerup",this.onPointerUp,this),this.physics.add.collider(this.ball,[this.lineGroupUpperBounds,this.lineGroupBounds,this.nextBasket.edgeGroup])}updateBackground(){this.fps.update(),this.background.tilePositionY-=1,this.cameras.main.setScroll(this.cameras.main.scrollX,this.ball.y-this.curBasket.y)}onHitLowerBound(){return t=this,e=void 0,a=function*(){this.gameOverAudio.play(),J.getScoreManager().saveScoreToLocalStorage();const t=this.firebase.getUser().displayName;this.firebase.addHighScore(t,J.getScoreManager().getCurScore()),this.scene.start("GameOverScene",{data:J.getScoreManager().getCurScore()})},new((s=void 0)||(s=Promise))((function(i,n){function o(t){try{r(a.next(t))}catch(t){n(t)}}function h(t){try{r(a.throw(t))}catch(t){n(t)}}function r(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,h)}r((a=a.apply(t,e||[])).next())}));var t,e,s,a}onHitCurrentBasket(){this.curBasket.reset(),this.ball.stateMachine.setState("idle",this.curBasket.x,this.curBasket.y),this.netAudio.play()}onHitObstacle(){this.nextBasket.vibrateX()}onHitNextBasket(){var t,e;if(this.ball.body){let s=0;const a=Math.atan2(null===(t=this.ball.body)||void 0===t?void 0:t.velocity.y,null===(e=this.ball.body)||void 0===e?void 0:e.velocity.x);this.netAudio.play(),s+=1,this.ball.stateMachine.setState("idle",this.nextBasket.x,this.nextBasket.y,J.getScoreManager().getCurScore()),this.nextBasket.rotation- -a<=.2&&(s+=1,this.perfectText.emitTextFadeInOut(this.nextBasket.x,this.nextBasket.y-50,1e3),Math.abs(this.ball.getBounds().centerX-this.star.getBounds().centerX)<50&&(J.getScoreManager().incrementStar(),this.clickAudio.play(),this.scoreText.setText(J.getScoreManager().getCurStar().toString()))),this.ball.isPowerUp()&&(this.cameras.main.flash(),s+=1,this.ball.disableSmoke()),this.incScoreText.setText("+"+s.toString()),this.ball.disablePowerUp(),J.getScoreManager().incrementScore(s),this.incScoreText.emitTextFadeInOut(this.nextBasket.x,this.nextBasket.y,1e3);const i=J.getScoreManager().getCurScore();this.curScoreText.text=i.toString(),i%5==0&&i>0&&this.ball.emitSmokeParticle(),this.updateBaskets(i)}}updateBaskets(t){t>=15?this.curBasket.stateMachine.setState("transit",1,1):t>=10?this.curBasket.stateMachine.setState("transit",1,2):t>=5?this.curBasket.stateMachine.setState("transit",1,3):this.curBasket.stateMachine.setState("transit",1),this.nextBasket.stateMachine.setState("transit",0),this.curBasket.moveFollower(this.star),this.nextBasket.moveFollower(this.ball);const e=this.curBasket;this.curBasket=this.nextBasket,this.nextBasket=e,this.curBasket.rotation=0}}class _ extends Phaser.Scene{constructor(){super({key:"PauseScene"})}create(){new v({scene:this,x:80,y:50,key:"settings",callback:()=>{J.getSceneManager().stateMachine.setState("setting",this,{data:"PauseScene"})},scale:.32}),new w({scene:this,x:630,y:50,key:"star",scale:.48}),new M({scene:this,x:680,y:50,msg:"0",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}),new M({scene:this,x:360,y:260,msg:"PAUSED",style:{fontSize:"100px",color:"#ababab",fontStyle:"bold"}}),new v({scene:this,x:360,y:390,key:"main-menu",callback:()=>{J.getSceneManager().stateMachine.setState("start",this)},scale:.32}),new v({scene:this,x:360,y:540,key:"leader-board",callback:()=>{console.log("Leaderboard")},scale:.32}),new v({scene:this,x:360,y:740,key:"resume",callback:()=>{J.getSceneManager().stateMachine.setState("resume",this)},scale:.36})}}class C extends Phaser.Scene{constructor(){super({key:"GameOverScene"})}updateLeaderboard(){let t="";this.firebase.getHighScores().then((e=>{e.forEach(((e,s)=>{t+=`\n${s+1}. ${e.name} ${e.score}`})),this.boardText.setText(t)}))}update(t){Math.floor(t/1e3)%10&&this.updateLeaderboard()}create(t){this.cameras.main.fadeIn(500,0,0,0),this.boardText=new M({scene:this,x:360,y:620,msg:"Fetching...",style:{fontFamily:"MilkyHoney",fontSize:"35px",color:"black"}}).setDepth(10),new w({scene:this,x:630,y:50,key:"star",scale:.48}),new M({scene:this,x:680,y:50,msg:J.getScoreManager().getStars().toString(),style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}),new M({scene:this,x:360,y:70,msg:"BEST SCORE",style:{fontSize:"50px",color:"#ffa500",fontStyle:"bold"}}),new M({scene:this,x:360,y:160,msg:J.getScoreManager().getBestScore().toString(),style:{fontSize:"90px",color:"#ffa500",fontStyle:"bold"}}),new M({scene:this,x:360,y:320,msg:t.data.toString(),style:{fontSize:"180px",color:"#ababab",fontStyle:"bold"}}),new v({scene:this,x:210,y:940,key:"ig",callback:()=>{window.location.href="https://www.facebook.com/khasang0412/"},scale:.4}),new v({scene:this,x:360,y:940,key:"return",callback:()=>{this.scene.start("PlayScene")},scale:.4}),new v({scene:this,x:510,y:940,key:"settings",callback:()=>{J.getSceneManager().stateMachine.setState("setting",this,{data:"over"})},scale:.32})}}const U=document.getElementById("game");class A extends Phaser.Scene{constructor(){super({key:"SettingScene"})}create(t){new v({scene:this,x:50,y:45,key:"close",callback:()=>{J.getSceneManager().stateMachine.setState(t.data,this)},scale:.4}),new M({scene:this,x:360,y:50,msg:"SETTINGS",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"#ababab"}}),new w({scene:this,x:630,y:50,key:"star",scale:.48}),new M({scene:this,x:680,y:50,msg:localStorage.getItem("star")||"0",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}),this.soundImgOn=new v({scene:this,x:360,y:540,key:"sound-on",callback:()=>{this.handleMuteSound()},scale:.2*1.5}).setAlpha(this.sound.mute?0:1),this.soundImgOff=new v({scene:this,x:360,y:540,key:"sound-off",callback:()=>{this.handleMuteSound()},scale:.2*1.5}).setAlpha(this.sound.mute?1:0),this.lightImgOn=new v({scene:this,x:360,y:420,key:"light-on",callback:()=>{this.handleToggleLight()},scale:.8}).setAlpha(U.style.backgroundColor==h?1:0),this.lightImgOff=new v({scene:this,x:360,y:420,key:"light-off",callback:()=>{this.handleToggleLight()},scale:.8}).setAlpha(U.style.backgroundColor==h?0:1)}handleMuteSound(){this.sound.mute?(this.sound.setMute(!1),this.soundImgOn.setAlpha(1),this.soundImgOff.setAlpha(0)):(this.sound.setMute(!0),this.soundImgOn.setAlpha(0),this.soundImgOff.setAlpha(1))}handleToggleLight(){U.style.backgroundColor===h?(U.style.backgroundColor="rgb(20, 24, 82)",this.lightImgOn.setAlpha(0),this.lightImgOff.setAlpha(1)):(U.style.backgroundColor=h,this.lightImgOn.setAlpha(1),this.lightImgOff.setAlpha(0))}}class F extends Phaser.Scene{constructor(){super({key:"CustomizeScene"}),this.lastPointer={x:0,y:0},null==localStorage.getItem("balls")&&(localStorage.setItem("balls",JSON.stringify([])),this.curBalls=[])}create(){this.curBalls=JSON.parse(localStorage.getItem("balls")),console.log(this.curBalls),this.cameras.main.setBounds(0,0,n,1900),this.input.on("pointermove",(t=>{t.isDown&&(this.cameras.main.scrollX+=this.lastPointer.x-t.x,this.cameras.main.scrollY+=this.lastPointer.y-t.y),this.lastPointer.x=t.x,this.lastPointer.y=t.y})),new M({scene:this,x:360,y:50,msg:"CHOOSE A BALL",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"#ababab"}}),new w({scene:this,x:630,y:50,key:"star",scale:.32}),this.starText=new M({scene:this,x:680,y:50,msg:localStorage.getItem("star"),style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}});const t=360;this.createBallButton(t,190,"ball_1",10),this.createBallButton(t,320,"ball_2",10),this.createBallButton(t,450,"ball_3",10),this.createBallButton(t,580,"ball_4",10),this.createBallButton(t,710,"ball_5",10),this.createBallButton(t,840,"ball_6",10),this.createBallButton(t,970,"ball_7",10),this.createBallButton(t,1100,"ball_8",10),this.createBallButton(t,1230,"ball_9",10),this.createBallButton(t,1360,"ball_10",10),this.createBallButton(t,1490,"ball_11",10),this.createBallButton(t,1620,"ball_12",10),this.createBallButton(t,1750,"ball_locked",10)}createBallButton(t,e,s,a){const i=new v({scene:this,x:t,y:e,key:s,callback:()=>{J.getSceneManager().stateMachine.setState("start",this,{skin:s})},scale:.3});if(!this.curBalls.includes(s)){i.setAlpha(.5);const n=new v({scene:this,x:t,y:e,key:"lock",scale:.3*1.5,callback:()=>{this.purchase(s,a)&&(i.setAlpha(1),n.destroy())}})}}purchase(t,e){const s=parseInt(this.starText.text);return s>e&&(this.curBalls.push(t),this.starText.text=(s-e).toString(),localStorage.setItem("balls",JSON.stringify(this.curBalls)),localStorage.setItem("star",this.starText.text),!0)}}let R=0;class z{constructor(t,e){this.states=new Map,this.id=(++R).toString(),this.isChangingState=!1,this.id=null!=e?e:this.id,this.context=t,this.changeStateQueue=[]}addState(t,e){var s,a,i;const n=this.context;return this.states.set(t,{name:t,onEnter:null===(s=null==e?void 0:e.onEnter)||void 0===s?void 0:s.bind(n),onUpdate:null===(a=null==e?void 0:e.onUpdate)||void 0===a?void 0:a.bind(n),onExit:null===(i=null==e?void 0:e.onExit)||void 0===i?void 0:i.bind(n)}),this}setState(t,e,s){var a,i,n;if(this.states.has(t)){if((null===(a=this.currentState)||void 0===a?void 0:a.name)!=t){if(this.isChangingState)return this.changeStateQueue.push(t),void console.log(`[StateMachine (${this.id})] change from ${null!==(n=null===(i=this.currentState)||void 0===i?void 0:i.name)&&void 0!==n?n:"none"} to ${t}`);this.isChangingState=!0,this.currentState&&this.currentState.onExit&&this.currentState.onExit(),this.currentState=this.states.get(t),this.currentState.onEnter&&(s?this.currentState.onEnter(e,s):this.currentState.onEnter(e)),this.isChangingState=!1}}else console.warn(`Tried to change to unknown state: ${t}`)}isCurrentState(t){return!!this.currentState&&this.currentState.name===t}update(t,e){this.changeStateQueue.length>0?this.setState(this.changeStateQueue.shift(),e):this.currentState&&this.currentState.onUpdate&&this.currentState.onUpdate(t)}}class L{constructor(){this.stateMachine=new z(this,"scene"),this.stateMachine.addState("preload",{onEnter:this.onPreloadEnter}).addState("play",{onEnter:this.onPlayEnter}).addState("start",{onEnter:this.onStartEnter}).addState("over",{onEnter:this.onOverEnter}).addState("pause",{onEnter:this.onPauseEnter}).addState("resume",{onEnter:this.onResumeEnter}).addState("setting",{onEnter:this.onSettingEnter}).addState("customize",{onEnter:this.onCustomizeEnter})}static getInstance(){return L.instance||(L.instance=new L),L.instance}onPreloadEnter(t){}onPlayEnter(t,e){t.scene.start(r,e)}onCustomizeEnter(t){t.scene.start("CustomizeScene")}onStartEnter(t){t.scene.start("StartScene")}onSettingEnter(t,e){t.scene.start("SettingScene",e)}onPauseEnter(t){t.scene.switch("PauseScene")}onResumeEnter(t){t.scene.switch(r)}onOverEnter(t,e){t.scene.start("GameOverScene",e)}}class X{constructor(){this.curScore=0,this.curStar=0,localStorage.getItem("star")?this.stars=parseInt(localStorage.getItem("star")):(localStorage.setItem("star","0"),this.stars=0),localStorage.getItem("high-score")?this.bestScore=parseInt(localStorage.getItem("high-score")):(localStorage.setItem("high-score","0"),this.bestScore=0)}static getInstance(){return X.instance||(X.instance=new X),X.instance}reset(){this.curScore=0,this.curStar=0}getCurScore(){return this.curScore}getBestScore(){return this.bestScore}getCurStar(){return this.curStar}getStars(){return this.stars}incrementScore(t){this.curScore+=t}incrementStar(){this.curStar++}saveScoreToLocalStorage(){this.bestScore=Math.max(this.bestScore,this.curScore),this.stars+=this.curStar,localStorage.setItem("high-score",this.bestScore.toString()),localStorage.setItem("star",this.stars.toString())}}class D{constructor(){this.sceneManager=L.getInstance(),this.scoreManager=X.getInstance()}static getInstance(){return D.instance||(D.instance=new D),D.instance}getScoreManager(){return this.scoreManager}getSceneManager(){return this.sceneManager}}var H=s(977),j=s(953),Y=s(155),Q=function(t,e,s,a){return new(s||(s=Promise))((function(i,n){function o(t){try{r(a.next(t))}catch(t){n(t)}}function h(t){try{r(a.throw(t))}catch(t){n(t)}}function r(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,h)}r((a=a.apply(t,e||[])).next())}))};const $={apiKey:"AIzaSyAF_Wawq4by-Rza3On2GbHV4TpyV2jyibg",authDomain:"dunk-shot-phaser.firebaseapp.com",projectId:"dunk-shot-phaser",storageBucket:"dunk-shot-phaser.appspot.com",messagingSenderId:"275371751196",appId:"1:275371751196:web:b2c651cdcc12ee3c282cd9",measurementId:"G-Y9XG2WQM39"};class W extends i().Plugins.BasePlugin{constructor(t){super(t);const e=(0,H.ZF)($);this.db=(0,j.ad)(e),this.auth=(0,Y.v0)(e),this.authStateChangedUnsubscribed=(0,Y.Aj)(this.auth,(t=>{t&&this.onLoggedInCallback&&this.onLoggedInCallback()}))}saveGameData(t,e){return Q(this,void 0,void 0,(function*(){yield(0,j.pl)((0,j.JU)(this.db,"game-data",t),e)}))}loadGameData(t){return Q(this,void 0,void 0,(function*(){return(yield(0,j.QT)((0,j.JU)(this.db,"game-data",t))).data()}))}createUserWithEmail(t,e){return Q(this,void 0,void 0,(function*(){return(yield(0,Y.Xb)(this.auth,t,e)).user}))}signInUserWithEmail(t,e){return Q(this,void 0,void 0,(function*(){return(yield(0,Y.e5)(this.auth,t,e)).user}))}signInAnonymously(){return Q(this,void 0,void 0,(function*(){yield(0,Y.XB)(this.auth)}))}signInWithPopup(){return Q(this,void 0,void 0,(function*(){const t=new Y.hJ,e=(0,Y.v0)();(0,Y.rh)(e,t,Y.n0).then((t=>t.user)).catch((t=>{console.log(t)}))}))}destroy(){this.authStateChangedUnsubscribed(),super.destroy()}onLoggedIn(t){this.onLoggedInCallback=t}getUser(){return this.auth.currentUser}addHighScore(t,e){return Q(this,void 0,void 0,(function*(){yield(0,j.ET)((0,j.hJ)(this.db,"high-scores"),{name:t,score:e})}))}getHighScores(){return Q(this,void 0,void 0,(function*(){const t=(0,j.IO)((0,j.hJ)(this.db,"high-scores"),(0,j.Xo)("score","desc"),(0,j.b9)(10));return(yield(0,j.PL)(t)).docs.map((t=>t.data()))}))}}const N={type:Phaser.AUTO,parent:"game",transparent:!0,canvasStyle:"border-left: 2px solid black; border-right: 2px solid black",scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:n,height:o},scene:[c,P,G,_,C,A,F],plugins:{global:[{key:"FirebasePlugin",plugin:W,start:!0,mapping:"firebase"}]},physics:{default:"arcade",arcade:{debug:!1}}};window.addEventListener("load",(()=>{new Phaser.Game(N)}));const J=D.getInstance()}},s={};function a(t){var i=s[t];if(void 0!==i)return i.exports;var n=s[t]={exports:{}};return e[t].call(n.exports,n,n.exports,a),n.exports}a.m=e,t=[],a.O=(e,s,i,n)=>{if(!s){var o=1/0;for(c=0;c<t.length;c++){for(var[s,i,n]=t[c],h=!0,r=0;r<s.length;r++)(!1&n||o>=n)&&Object.keys(a.O).every((t=>a.O[t](s[r])))?s.splice(r--,1):(h=!1,n<o&&(o=n));if(h){t.splice(c--,1);var l=i();void 0!==l&&(e=l)}}return e}n=n||0;for(var c=t.length;c>0&&t[c-1][2]>n;c--)t[c]=t[c-1];t[c]=[s,i,n]},a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};a.O.j=e=>0===t[e];var e=(e,s)=>{var i,n,[o,h,r]=s,l=0;if(o.some((e=>0!==t[e]))){for(i in h)a.o(h,i)&&(a.m[i]=h[i]);if(r)var c=r(a)}for(e&&e(s);l<o.length;l++)n=o[l],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(c)},s=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var i=a.O(void 0,[216],(()=>a(960)));i=a.O(i)})();