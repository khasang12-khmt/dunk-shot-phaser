(()=>{"use strict";var t,e={256:(t,e,s)=>{s.d(e,{r:()=>dt});var i=s(260),a=s.n(i);const n=715,o=1080,h="rgb(240, 240, 240)",r=180,l="PlayScene",c={WALL:0,LOWER_BOUND:1,UPPER_BOUND:2,OBSTACLE:3,CURRENT_BASKET:4,NEXT_BASKET:5};class d extends Phaser.Scene{constructor(){super({key:"PreloadScene"})}preload(){dt.getSceneManager().stateMachine.setState("preload",this),this.showProgress(),this.preloadMaps(),this.preloadButtons(),this.preloadBalls(),this.preloadThemes(),this.preloadSprites(),this.preloadAudio()}create(){dt.getSceneManager().stateMachine.setState("start",this)}showProgress(){const t=this.add.graphics();t.fillStyle(16777215,1);const e=t.fillRect(357.5,540,0,30),s=this.add.text(357.5,525,"0%",{fontFamily:"MilkyHoney",fontSize:"40px",color:"#ababab"});s.setOrigin();const i=this.add.text(357.5,560,"0%",{fontFamily:"MilkyHoney",fontSize:"25px",color:"#ababab"});i.setOrigin(),this.load.on("progress",(function(t){e.fillRect(232.5,590,250*t,30),s.setText(Math.floor(100*t)+"%")})),this.load.on("fileprogress",(function(t){i.setText("Loading "+t.type+": "+t.key+" "+(t.bytesTotal/1024).toFixed(2)+"KB")})),this.load.on("complete",(()=>{t.destroy(),s.destroy(),i.destroy(),e.destroy()}))}preloadButtons(){this.load.setPath("assets/images/buttons/"),this.load.image("close","Close.png"),this.load.image("close","Divide.png"),this.load.image("close","Facebook.png"),this.load.image("f-left","ForwardLeft.png"),this.load.image("f-right","ForwardRight.png"),this.load.image("game-pad","GamePad.png"),this.load.image("google","Google.png"),this.load.image("heart","Heart.png"),this.load.image("home","Home.png"),this.load.image("ig","Instagram.png"),this.load.image("ad","ad.png"),this.load.image("return","return.png"),this.load.image("trophy","Trophy.png"),this.load.image("trash","Trash.png"),this.load.image("sound-on","sound-on.png"),this.load.image("sound-off","sound-off.png"),this.load.image("light-on","light-on.png"),this.load.image("light-off","light-off.png"),this.load.image("shop","Shop.png"),this.load.image("share","Share.png"),this.load.image("settings","Settings.png"),this.load.image("right","Right.png"),this.load.image("retry","Retry.png"),this.load.image("question","Question.png"),this.load.image("pow-up","PowerUp.png"),this.load.image("left","Left.png"),this.load.image("menu","Menu.png"),this.load.image("msg","Message.png"),this.load.image("music","Music.png"),this.load.image("minus","Minus.png"),this.load.image("pause","Pause.png"),this.load.image("play","Play.png"),this.load.image("plus","Plus.png"),this.load.image("free-gift","FreeGift.png"),this.load.image("drag-it","DragIt.png"),this.load.image("customize","customize.png"),this.load.image("challenge","challenge.png"),this.load.image("leaderboard","Leaderboard.png"),this.load.image("leader-board","leader-board.png"),this.load.image("main-menu","mainmenu.png"),this.load.image("resume","resume.png"),this.load.image("lock","lock.png")}preloadBalls(){this.load.setPath("assets/images/colorful-balls/"),this.load.image("ball_1","1.png"),this.load.image("ball_2","2.png"),this.load.image("ball_3","3.png"),this.load.image("ball_4","4.png"),this.load.image("ball_5","5.png"),this.load.image("ball_6","6.png"),this.load.image("ball_7","7.png"),this.load.image("ball_8","8.png"),this.load.image("ball_9","9.png"),this.load.image("ball_10","10.png"),this.load.image("ball_11","11.png"),this.load.image("ball_12","12.png"),this.load.image("ball_locked","Locked.png")}preloadSprites(){this.load.setPath("assets/images/sprites/"),this.load.image("dot","Dot_0.png"),this.load.image("ball","ball.png"),this.load.image("hoop-down","hoop_1.png"),this.load.image("hoop-up","hoop_2.png"),this.load.image("basket","basket.png"),this.load.image("logo","logo.png"),this.load.image("net","net.png"),this.load.image("star","star.png"),this.load.image("shadow","shadow.png"),this.load.image("flare","flare.png"),this.load.image("spark","spark.png"),this.load.spritesheet("flag","flag.png",{frameWidth:60,frameHeight:60}),this.load.atlas("flares","flares.png","flares.json")}preloadThemes(){this.load.setPath("assets/images/theme-game-mode/"),this.load.image("bg_0","0/bg_0.png"),this.load.image("bg_1","1/bg_1.png"),this.load.image("bg_2","2/bg_2.png"),this.load.image("wall_0","0/wall_0.png"),this.load.image("wall_1","1/wall_1.png"),this.load.image("wall_2","2/wall_2.png"),this.load.image("theme_0","0.png"),this.load.image("theme_1","1.png"),this.load.image("theme_2","2.png"),this.load.image("theme_3","3.png"),this.load.image("theme_4","4.png"),this.load.image("check","check.png"),this.load.image("check","popup.png")}preloadAudio(){this.load.setPath("assets/audio/"),this.load.audio("bounce","Bounce.wav"),this.load.audio("click","Click.wav"),this.load.audio("game-over","GameOver.wav"),this.load.audio("net","Net.wav"),this.load.audio("shoot","Shoot.mp3")}preloadMaps(){this.load.tilemapTiledJSON("level1","assets/maps/bounce.json"),this.load.tilemapTiledJSON("level2","assets/maps/bounce2.json"),this.load.tilemapTiledJSON("level3","assets/maps/bounce3.json"),this.load.image("tiles","assets/tiles/tiles.png"),this.load.scenePlugin("AnimatedTiles","AnimatedTiles.js","animatedTiles","animatedTiles")}}class g extends Phaser.GameObjects.Graphics{constructor(t,e,s){super(t,{x:e,y:s}),this.radius=40,this.alpha=1,t.add.existing(this)}emitSmoke(t,e,s){this.clear(),this.setX(t),this.setY(e),this.fillStyle(s,this.alpha),this.fillCircle(0,0,this.radius),this.scene.tweens.add({targets:this,y:this.y-75,alpha:0,duration:500}),this.scene.tweens.add({targets:this,scaleX:3,scaleY:.3,y:this.y-75,ease:"Quad.easeOut",duration:300,onComplete:()=>{this.destroy()}})}}let u=0;class p{constructor(t,e){this.states=new Map,this.id=(++u).toString(),this.isChangingState=!1,this.id=null!=e?e:this.id,this.context=t,this.changeStateQueue=[]}addState(t,e){var s,i,a;const n=this.context;return this.states.set(t,{name:t,onEnter:null===(s=null==e?void 0:e.onEnter)||void 0===s?void 0:s.bind(n),onUpdate:null===(i=null==e?void 0:e.onUpdate)||void 0===i?void 0:i.bind(n),onExit:null===(a=null==e?void 0:e.onExit)||void 0===a?void 0:a.bind(n)}),this}setState(t,...e){var s,i;if(this.states.has(t)){if(this.isChangingState)return this.changeStateQueue.push(t),void console.log(`[StateMachine (${this.id})] change from ${null!==(i=null===(s=this.currentState)||void 0===s?void 0:s.name)&&void 0!==i?i:"none"} to ${t}`);this.isChangingState=!0,this.currentState&&this.currentState.onExit&&this.currentState.onExit(),this.currentState=this.states.get(t),this.currentState.onEnter&&this.currentState.onEnter(e),this.isChangingState=!1}else console.warn(`Tried to change to unknown state: ${t}`)}isCurrentState(t){return!!this.currentState&&this.currentState.name===t}update(t){this.changeStateQueue.length>0?this.setState(this.changeStateQueue.shift()):this.currentState&&this.currentState.onUpdate&&this.currentState.onUpdate(t)}}function b(){return Math.random()*Math.PI}function y(t,e){return t*Math.cos(e)}function S(t,e){return t*Math.sin(e)}function m(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}function f(t,e){return Math.atan2(e,t)}class x extends Phaser.Physics.Arcade.Sprite{constructor(t){super(t.scene,t.x,t.y,t.key),this.setOrigin(.5,.5),this.scale=t.scale?t.scale:1,this.setScale(t.scale),this.body=this.body}}const k={frame:"white",color:[16436258,16291840,16266752,10421252],colorEase:"quad.out",lifespan:100,rotate:90,scale:{start:.7,end:0,ease:"sine.out"},speed:200,advance:500,frequency:60,blendMode:"ADD",duration:200},v={color:[14819916,14833698,14858274,6908265,16119285],alpha:{start:.9,end:.1,ease:"sine.easeout"},angle:{min:0,max:360},rotate:{min:0,max:360},speed:{min:40,max:70},colorEase:"quad.easeinout",lifespan:1500,scale:.5,frequency:60};class M extends x{constructor(t){var e;super(t),this.elapsed=0,this.isMoving=!1,this.powerUp=!1,this.scene.physics.add.existing(this),this.disableBody(!0,!0),null===(e=this.body)||void 0===e||e.setCircle(this.width/2),this.setBounce(.75,.75),this.setVisible(!0),this.setGravityY(980),this.setOrigin(.5,.5),this.setCollideWorldBounds(!1,1,1,!0),this.scene.add.existing(this),this.stateMachine=new p(this,"ball"),this.stateMachine.addState("idle",{onEnter:this.onIdleEnter}).addState("demo",{onUpdate:this.onDemoUpdate}).addState("snipe",{onEnter:this.onSnipeEnter,onExit:this.onSnipeExit}).addState("fly",{onEnter:this.onFlyEnter,onUpdate:this.onFlyUpdate}),this.stateMachine.setState("snipe")}update(t){this.stateMachine.update(t)}onIdleEnter(t){if(t.length>0){const[e,s,i]=t;i&&i%5==0&&i>0&&0==this.powerUp&&(this.powerUp=!0),this.scene.tweens.add({targets:this,x:e,y:s,duration:100,ease:"Sine.easeInOut"}),this.setVelocity(0,0),this.disableBody(!0,!1),this.isMoving=!1}}emitSmokeParticle(){this.smokeParticle=this.scene.add.particles(100,100,"dot",v),this.smokeParticle.startFollow(this,-90,-120,!0)}disableSmoke(){this.smokeParticle.stop()}onDemoUpdate(t){this.rotation+=.05;let e=this.elapsed/3500*t/16;const s=110+e*(2*(1-e)*90+465*e),i=900+e*(2*(1-e)*-900+-330*e);this.x=s,this.y=i,s>=575&&i>=570&&(e=0,this.elapsed=0),this.elapsed+=this.scene.game.loop.delta}onFlyEnter(t){var e;const[s,i]=t;this.smokeLaunch=new g(this.scene,0,0),this.smokeLaunch.emitSmoke(s,i,11250603);const a=-this.radian;if(this.speed>0){this.isMoving=!0;const t=7.5*Math.min(this.speed,r);this.enableBody(!0,s,i,!0,!0),this.setVelocity(y(t,a),S(t,a)),this.scene.physics.velocityFromRotation(a,t,null===(e=this.body)||void 0===e?void 0:e.velocity)}}onFlyUpdate(t){this.isMoving&&(this.rotation+=.2)}onSnipeEnter(t){this.speed=t[0],this.radian=t[1],this.points=this.scene.add.graphics(),this.points.fillStyle(16753920,1),function(t,e,s,i,a,n,o){const h=[];for(let t=0;t<6;t++){const n=.2*t;let o=e+y(7.5*Math.min(r,i),a)*n;const l=s-S(7.5*Math.min(r,i),a)*n+490*Math.pow(n,2);o<0?o=-o:o>715&&(o=715-(o-715)),h.push({x:o,y:l})}for(let e=0;e<6;e++){const s=h[e];t.fillCircle(s.x,s.y,12-e)}}(this.points,this.x,this.y,this.speed,this.radian)}onSnipeExit(){this.points.destroy()}isPowerUp(){return this.powerUp&&this.smokeParticle}disablePowerUp(){this.powerUp=!1}isFlying(){return this.isMoving}isFlyingDown(){var t;return((null===(t=this.body)||void 0===t?void 0:t.velocity.y)||0)>0}isOverlap(){var t,e,s,i;return console.log(null===(t=this.body)||void 0===t?void 0:t.overlapX,null===(e=this.body)||void 0===e?void 0:e.overlapY),(this.body?m(null===(s=this.body)||void 0===s?void 0:s.overlapX,null===(i=this.body)||void 0===i?void 0:i.overlapY):0)>.1*this.width}isOutOfBounds(){return this.x-this.width*this.scale<0||this.x>n-this.width*this.scale}onNotify(t){const e=dt.getScoreManager().getCurScore();switch(t){case c.CURRENT_BASKET:this.smokeLaunch=new g(this.scene,0,0),this.smokeLaunch.emitSmoke(this.x,this.y,11250603);break;case c.NEXT_BASKET:this.smokeLaunch=new g(this.scene,0,0),this.smokeLaunch.emitSmoke(this.x,this.y,30932),this.isPowerUp()&&(this.disableSmoke(),this.disablePowerUp()),e%5==0&&e>0&&this.emitSmokeParticle();break;case c.WALL:this.flameParticle=this.scene.add.particles(this.x,this.y,"flares",k),this.flameParticle.setDepth(1),this.flameParticle.once("complete",(()=>{this.flameParticle.destroy()}))}}}class w extends Phaser.GameObjects.Container{constructor(t){super(t.scene,t.x,t.y),this.scaleRatio=t.scale,this.button=t.scene.add.sprite(0,0,t.key).setInteractive(),this.add(this.button),this.text=t.scene.add.text(0,0,t.text,{color:"#ffffff",fontSize:"27px",fontFamily:"Roboto",fontStyle:"bold"}),this.text.setOrigin(.5),this.add(this.text),this.callback=t.callback,t.scene.add.existing(this),this.button.on("pointerdown",this.onPointerDown,this),this.button.on("pointerup",this.onPointerUp,this),this.button.on("pointerout",this.onPointerOut,this),this.button.setScale(this.scaleRatio)}onPointerDown(){this.button.setScale(.9*this.scaleRatio)}onPointerUp(){this.button.setScale(this.scaleRatio),this.callback()}onPointerOut(){this.button.setScale(this.scaleRatio)}}class C extends Phaser.GameObjects.Image{constructor(t){super(t.scene,t.x,t.y,t.key,t.frame),this.scaleRatio=t.scale?t.scale:1,this.setScale(this.scaleRatio),t.scene.add.existing(this)}}class T extends C{constructor(t){super(t),this.setInteractive(),this.on("pointerdown",this.onPointerDown,this),this.on("pointerup",this.onPointerUp,this),this.on("pointerout",this.onPointerOut,this),this.setScale(this.scaleRatio),this.callback=t.callback}onPointerDown(){this.setScale(.9*this.scaleRatio)}onPointerUp(){this.setScale(this.scaleRatio),this.callback()}onPointerOut(){this.setScale(this.scaleRatio)}enableOscillator(){this.scene.tweens.add({targets:this,scaleX:.25,scaleY:.25,yoyo:!0,repeat:-1,duration:1e3,ease:"Quad.easeInOut"})}}class E extends Phaser.GameObjects.Text{constructor(t){super(t.scene,t.x,t.y,t.msg,t.style),this.setOrigin(.5),this.scene.add.existing(this)}emitTextFadeInOut(t,e,s){this.setX(t),this.setY(e),this.setAlpha(1),this.scene.tweens.add({targets:this,alpha:0,duration:1e3,ease:"ease.sineInOut",onComplete:()=>{this.setAlpha(0)}})}}class P extends T{constructor(t){super(t)}onPointerDown(){this.setScale(.9*this.scaleRatio),this.callback()}}class B extends Phaser.Scene{constructor(){super({key:"StartScene"})}create(t){new T({scene:this,x:50,y:50,key:"settings",callback:()=>{dt.getSceneManager().stateMachine.setState("setting",this,{data:"start"})},scale:.2*1.5}),new T({scene:this,x:160,y:50,key:"leaderboard",callback:()=>{console.log("leaderboard")},scale:.36}),new C({scene:this,x:625,y:50,key:"star",scale:.48}),new E({scene:this,x:675,y:50,msg:localStorage.getItem("star")||"0",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}),new C({scene:this,x:357.5,y:370,key:"logo",scale:.48}),new P({scene:this,x:110,y:880,key:"basket",scale:.75,callback:()=>{this.firebase.getUser()?this.loadPlayScene(t):(this.firebase.signInWithPopup(),this.firebase.onLoggedIn((()=>{this.loadPlayScene(t)})))}}).setDepth(2),new C({scene:this,x:575,y:570,key:"basket",scale:.75}).setDepth(2),this.ball=new M({scene:this,x:110,y:900,key:"ball",scale:.2}).setDepth(1),t.skin?this.ball.setTexture(t.skin):this.ball.setTexture("ball"),this.ball.stateMachine.setState("demo"),new T({scene:this,x:100,y:990,key:"drag-it",callback:()=>{this.firebase.getUser()?this.loadPlayScene(t):(this.firebase.signInWithPopup(),this.firebase.onLoggedIn((()=>{this.loadPlayScene(t)})))},scale:.3*1.5}).enableOscillator(),new w({scene:this,x:525,y:890,key:"customize",text:"",scale:.2*1.5,callback:()=>{dt.getSceneManager().stateMachine.setState("customize",this)}}),new w({scene:this,x:525,y:1020,key:"challenge",text:"",scale:.3*1.5,callback:()=>{this.registry.set("level","level1"),t.skin?dt.getSceneManager().stateMachine.setState("challenge",this,t):dt.getSceneManager().stateMachine.setState("challenge",this,{skin:"ball"})}})}update(t,e){this.ball.update(e)}loadPlayScene(t){this.cameras.main.fadeOut(500,0,0,0),this.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(()=>{t.skin?dt.getSceneManager().stateMachine.setState("play",this,t):dt.getSceneManager().stateMachine.setState("play",this,{skin:"ball"})}))}}class O{constructor(){this.subscribers=new Set}static getInstance(){return O.instance||(O.instance=new O),O.instance}subscribe(t){this.subscribers.add(t)}unsubscribe(t){this.subscribers.delete(t)}notify(t){for(const e of this.subscribers)e.onNotify(t)}}class I{static getInstance(){return I.instance||(I.instance=new I),I.instance}onPointerDown(t){this.dragStart={x:t.x,y:t.y}}isDragging(){return null!=this.dragStart}emitDragLeave(){this.dragStart=null}estimateVelocityAndAngle(t){return this.dragStart?function(t,e){const s=Phaser.Math.Angle.Between(t.x,t.y,e.x,e.y);return[Phaser.Math.Distance.Between(t.x,t.y,e.x,e.y),s]}(this.dragStart,t):[0,0]}}class A{constructor(){this.soundList=new Map}static getInstance(){return A.instance||(A.instance=new A),A.instance}addSound(t,e){this.soundList.set(t,e)}getSound(t){return this.soundList.has(t)&&this.soundList.get(t),null}playSound(t){var e;this.soundList.has(t)&&(null===(e=this.soundList.get(t))||void 0===e||e.play())}}const _={scaleX:.25,scaleY:.25,yoyo:!0,loop:-1,ease:"sine.inout"};class U extends x{constructor(t){super(t),this.setInteractive(),this.scene.physics.add.existing(this),this.disableBody(!1,!0),this.setVisible(!0),this.scene.add.existing(this),this.scene.tweens.add(Object.assign({targets:this},_)),this.stateMachine=new p(this,"ball"),this.stateMachine.addState("enable",{onEnter:this.onEnableEnter}).addState("disable",{onEnter:this.onDisableEnter}),this.stateMachine.setState("disable")}onEnableEnter(){0==this.visible&&(this.enableBody(!1),this.setVisible(!0))}onDisableEnter(){1==this.visible&&(this.disableBody(!1),this.setVisible(!1))}}const L={duration:1e3,ease:"Power1",yoyo:!0,repeat:-1},N={angle:Phaser.Math.Between(-45,45),duration:1e3,ease:"Linear",yoyo:!0,repeat:-1},G={duration:20,ease:"Linear",yoyo:!0,repeat:3};class R extends x{constructor(t){super(t),this.setOrigin(.5,.5),this.createMultiBody(),this.scene.physics.add.existing(this),this.disableBody(!0,!1),this.scene.add.existing(this),this.stateMachine=new p(this,"ball"),this.stateMachine.addState("idle",{onEnter:this.onIdleEnter}).addState("snipe",{onEnter:this.onSnipeEnter}).addState("transit",{onEnter:this.onTransitEnter}),this.stateMachine.setState("idle")}createMultiBody(){const t=40,e={allowGravity:!1,immovable:!0,visible:!1};this.bodyRects=[this.scene.add.rectangle(this.x-t,this.y,t,t),this.scene.add.rectangle(this.x,this.y,t,t),this.scene.add.rectangle(this.x+t,this.y,t,t)],this.edgeRects=[this.scene.add.rectangle(this.x-70,this.y-15,5,5),this.scene.add.rectangle(this.x+70,this.y-15,5,5)],this.openRects=[this.scene.add.rectangle(this.x-25,this.y-25,20,35),this.scene.add.rectangle(this.x+25,this.y-25,20,35)],this.bodyGroup=this.scene.physics.add.group(e),this.openGroup=this.scene.physics.add.group(e),this.edgeGroup=this.scene.physics.add.group(Object.assign(Object.assign({},e),{bounceX:.02,bounceY:.02})),this.bodyGroup.addMultiple(this.bodyRects),this.edgeGroup.addMultiple(this.edgeRects),this.openGroup.addMultiple(this.openRects)}updateBody(){this.enableBody(!1),this.updateBodyGroup(),this.updateEdgeGroup(),this.updateOpenGroup()}updateBodyGroup(){const t=y(40,this.rotation),e=S(40,this.rotation);this.bodyGroup.setX(this.x-t,t),this.bodyGroup.setY(this.y-e,e)}updateEdgeGroup(){const t=f(this.width,this.height),e=m(this.width,this.height)*(this.scale-.1)/2;this.edgeGroup.setX(this.x-y(e,-this.rotation-t),y(e,-this.rotation+t)+y(e,-this.rotation-t)),this.edgeGroup.setY(this.y+S(e,-this.rotation-t),-S(e,-this.rotation+t)-S(e,-this.rotation-t))}updateOpenGroup(){const t=f(this.width,this.height),e=m(this.width,this.height)*(this.scale-.3)/4;this.openGroup.setX(this.x-y(e,-this.rotation-t),y(e,-this.rotation+t)+y(e,-this.rotation-t)),this.openGroup.setY(this.y+S(e,-this.rotation-t),-S(e,-this.rotation+t)-S(e,-this.rotation-t))}transition(t,e,s,i,a){this.scene.tweens.add({targets:t,x:e,y:s,duration:1e3,ease:"Sine.easeInOut",onComplete:()=>{this.updateBodyGroup(),this.updateEdgeGroup(),i&&(this.updateOpenGroup(),1==a?this.addRotating():2==a?this.addMovingX():3==a&&this.addMovingY())}})}onTransitEnter(t){const[e,s]=[n,o],[i,a,h]=t;var r,l;0==i?this.transition(this,this.x,this.y,!1,a):(this.y=h-s,this.newY=h-(r=s/4,l=s/3,Math.floor(Math.random()*(l-r+1))+r),this.transition(this,this.x,this.newY,!0,a))}onIdleEnter(){this.clearEffect(),this.scene.tweens.add({targets:this,scaleY:this.scaleX,duration:5e3,ease:"Power2"}),this.updateEdgeGroup()}onSnipeEnter(t){const[e,s]=t;this.rotation=s-Math.PI/2,this.setScale(this.scaleX,Math.max(1.3*this.scaleX*Math.min(e,r)/r,1.2*this.scaleX)),this.updateEdgeGroup()}moveFollower(t){const[e,s]=[n,o];t instanceof M?(this.transition(t,this.x,this.y,!1),this.clearEffect()):t instanceof U&&(this.x>e/2?this.setRotation(-b()/2):this.setRotation(b()/2),this.transition(t,this.x+y(80,Math.PI/2-this.rotation),this.newY-S(80,Math.PI/2-this.rotation),!1),t.setAlpha(1))}reset(){this.scene.tweens.add({targets:this,angle:0,duration:500,ease:"Power2"})}vibrateX(){this.scene.tweens.add(Object.assign({targets:this,x:this.x-10},G))}vibrateY(){this.scene.tweens.add(Object.assign({targets:this,y:this.y-10},G))}addMovingX(){this.tweensX=this.scene.tweens.add(Object.assign({targets:this,x:this.x-25,onUpdate:()=>{this.updateBodyGroup(),this.updateEdgeGroup(),this.updateOpenGroup()}},L))}addMovingY(){this.tweensY=this.scene.tweens.add(Object.assign({targets:this,y:this.y+30,onUpdate:()=>{this.updateBodyGroup(),this.updateEdgeGroup(),this.updateOpenGroup()}},L))}addRotating(){this.tweensAngle=this.scene.tweens.add(Object.assign({targets:this,onUpdate:()=>{this.updateBodyGroup(),this.updateEdgeGroup(),this.updateOpenGroup()}},N))}clearEffect(){this.tweensX&&this.tweensX.stop(),this.tweensY&&this.tweensY.stop(),this.tweensAngle&&this.tweensAngle.stop()}}class D{setCur(t){this.curBasket=t}setNext(t){this.nextBasket=t}getCur(){return this.curBasket}getNext(){return this.nextBasket}swap(){const t=this.curBasket;this.curBasket=this.nextBasket,this.nextBasket=t,this.curBasket.reset()}onNotify(t){const e=dt.getScoreManager().getCurScore(),s=this.nextBasket.y;switch(t){case c.CURRENT_BASKET:this.curBasket.reset();break;case c.OBSTACLE:this.nextBasket.vibrateX();break;case c.NEXT_BASKET:e>=15?this.getCur().stateMachine.setState("transit",1,1,s):e>=10?this.getCur().stateMachine.setState("transit",1,2,s):e>=5?this.getCur().stateMachine.setState("transit",1,3,s):this.getCur().stateMachine.setState("transit",1,-1,s),this.getNext().stateMachine.setState("transit",0),this.swap()}}}class F extends Phaser.GameObjects.TileSprite{constructor(t){super(t.scene,t.x,t.y,t.w,t.h,t.key),this.scaleRatio=t.scale?t.scale:1,this.setScale(this.scaleRatio),t.scene.add.existing(this)}}class Y extends Phaser.GameObjects.Text{constructor(t){super(t,317.5,20,"",{color:"#ffa500",fontSize:"28px",fontStyle:"bold"}),t.add.existing(this),this.setOrigin(0)}update(){this.setText(`fps: ${Math.floor(this.scene.game.loop.actualFps)}`)}}class j extends Phaser.Scene{constructor(){super({key:"PlayScene"}),this.basketCtrl=new D}createAssets(){const[t,e]=[n,o];this.fps=new Y(this),this.background=new F({scene:this,x:t/2,y:e/2,w:4096,h:4096,key:"wall_0",scale:.45}),this.wallImg=new C({scene:this,x:t/2,y:e/2,key:"bg_0"}).setAlpha(.6).setScale(.55),this.pauseImg=new T({scene:this,x:80,y:50,key:"pause",callback:()=>{dt.getSceneManager().stateMachine.setState("pause",this)},scale:.12}),this.starImg=new C({scene:this,x:t-90,y:50,key:"star",scale:.32}).setDepth(1),this.scoreText=new E({scene:this,x:t-40,y:50,msg:"0",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}).setDepth(1),this.curScoreText=new E({scene:this,x:t/2,y:e/2-120,msg:dt.getScoreManager().getCurScore().toString(),style:{fontSize:"150px",color:"#ababab",fontStyle:"bold"}}),this.perfectText=new E({scene:this,x:-100,y:-100,msg:"PERFECT !!",style:{fontSize:"30px",color:"#ffa500",fontStyle:"bold"}}),this.flagText=new E({scene:this,x:-200,y:-200,msg:"SKYBALL !!",style:{fontSize:"30px",color:"#00008b",fontStyle:"bold"}}),this.incScoreText=new E({scene:this,x:-100,y:-100,msg:"+1",style:{fontSize:"50px",color:"red",fontStyle:"bold"}}),this.anims.create({key:"flags",frames:this.anims.generateFrameNumbers("flag",{frames:[0,1,2,3,4]}),frameRate:8,repeat:-1}),this.flag=this.add.sprite(n,-130,"flags"),this.flag.play("flags").setScale(4).setAngle(270).setAlpha(0)}createWall(){const[t,e]=[n,o],s=this.add.line(0,0,0,2*-e,0,2*e),i=this.add.line(t,0,t,2*-e,t,2*e);this.lineGroupBounds=this.physics.add.group({allowGravity:!1,immovable:!0,visible:!0,bounceX:1,bounceY:1}),this.lineGroupBounds.add(s),this.lineGroupBounds.add(i)}createObjects(t){this.star=new U({scene:this,x:625,y:50,key:"star",scale:.32});const e=new R({scene:this,x:130,y:740,key:"basket",callback:(t,e,s,i)=>{this.ball.stateMachine.setState("fly",t,e,s,i)},scale:.65}).setDepth(2).setMaxVelocity(0,0);this.basketCtrl.setCur(e);const s=new R({scene:this,x:575,y:340,key:"basket",callback:(t,e,s,i)=>{this.ball.stateMachine.setState("fly",t,e,s,i)},scale:.65}).setDepth(2).setMaxVelocity(0,0);this.basketCtrl.setNext(s),this.ball=new M({scene:this,x:125,y:740,key:"ball",scale:.12}).setDepth(1),t&&this.ball.setTexture(t.skin),this.physics.world.setFPS(60)}subscribe(){this.input.on("pointerdown",this.inputManager.onPointerDown,this.inputManager),this.input.on("pointermove",this.onPointerMove,this),this.input.on("pointerup",this.onPointerUp,this),this.physics.add.collider(this.ball,[this.lineGroupBounds,this.basketCtrl.getNext().edgeGroup]),this.eventManager.subscribe(this),this.eventManager.subscribe(this.ball),this.eventManager.subscribe(this.basketCtrl)}create(t){dt.getScoreManager().reset(),this.eventManager=new O,this.inputManager=I.getInstance(),this.soundManager=A.getInstance(),this.soundManager.addSound("net",this.sound.add("net")),this.soundManager.addSound("shoot",this.sound.add("shoot")),this.soundManager.addSound("click",this.sound.add("click")),this.soundManager.addSound("over",this.sound.add("game-over")),this.createAssets(),this.createObjects(t),this.createWall(),this.subscribe(),this.cameras.main.startFollow(this.ball,!1,0,.1,-240,240)}onPointerUp(t){this.inputManager.isDragging()&&!this.ball.isFlying()&&(this.basketCtrl.getCur().stateMachine.setState("idle"),this.ball.stateMachine.setState("fly",this.basketCtrl.getCur().x,this.basketCtrl.getCur().y),this.inputManager.emitDragLeave(),this.soundManager.playSound("shoot"))}onPointerMove(t){if(t.isDown&&this.inputManager.isDragging()&&!this.ball.isFlying()){const[e,s]=this.inputManager.estimateVelocityAndAngle(t);this.basketCtrl.getCur().stateMachine.setState("snipe",e,s),this.ball.stateMachine.setState("snipe",e,Math.PI/2-this.basketCtrl.getCur().rotation)}}update(t,e){this.ball.update(e),this.updateBackground(),this.ball.y>this.basketCtrl.getCur().y+200&&this.eventManager.notify(c.LOWER_BOUND),this.basketCtrl.getCur().y-this.ball.y>540&&this.eventManager.notify(c.UPPER_BOUND),this.ball.isFlyingDown()&&this.physics.collide(this.ball,this.basketCtrl.getCur().bodyGroup)&&this.eventManager.notify(c.CURRENT_BASKET),this.physics.overlap(this.ball,this.basketCtrl.getNext().openGroup)&&this.physics.overlap(this.ball,this.basketCtrl.getNext().bodyGroup)&&this.eventManager.notify(c.NEXT_BASKET),this.physics.collide(this.ball,this.basketCtrl.getNext().bodyGroup)&&this.eventManager.notify(c.OBSTACLE),this.ball.isOutOfBounds()&&this.eventManager.notify(c.WALL),this.physics.overlap(this.ball,this.star)&&this.eventManager.notify(c.STAR)}updateBackground(){const t=this.cameras.main.scrollY;this.fps.update(),this.background.tilePositionY-=1,this.pauseImg.setY(t+50),this.fps.setY(t+50),this.starImg.setY(t+50),this.scoreText.setY(t+50),this.flag.setY(t+n),this.lineGroupBounds.setY(t),this.curScoreText.setY(t+357.5),this.wallImg.setY(t+540),this.background.setY(t+540)}onNotify(t){switch(t){case c.UPPER_BOUND:this.onHitUpperBound();break;case c.LOWER_BOUND:this.onHitLowerBound();break;case c.CURRENT_BASKET:this.onHitCurrent();break;case c.NEXT_BASKET:this.onHitNext();break;case c.STAR:this.onHitStar()}}onHitLowerBound(){if(this.soundManager.playSound("over"),0==dt.getScoreManager().getCurScore())return this.ball.setPosition(this.basketCtrl.getCur().x,this.basketCtrl.getCur().y-20),this.ball.stateMachine.setState("idle",this.basketCtrl.getCur().x,this.basketCtrl.getCur().y),void(1==this.flag.alpha&&this.flag.setAlpha(0));dt.getScoreManager().saveScoreToLocalStorage(),this.firebase.addHighScore(this.firebase.getUser()?this.firebase.getUser().displayName:"test",dt.getScoreManager().getCurScore()),this.scene.start("GameOverScene",{data:dt.getScoreManager().getCurScore()}),1==this.flag.alpha&&this.flag.setAlpha(0)}onHitUpperBound(){this.flag.setAlpha(1)}onHitCurrent(){this.ball.stateMachine.setState("idle",this.basketCtrl.getCur().x,this.basketCtrl.getCur().y),this.soundManager.playSound("net"),this.flag.setAlpha(0)}onHitStar(){dt.getScoreManager().incrementStar(),this.soundManager.playSound("click"),this.scoreText.setText(dt.getScoreManager().getCurStar().toString()),this.star.stateMachine.setState("disable")}onHitNext(){var t,e;if(this.ball.body){let s=0;const i=Math.atan2(null===(t=this.ball.body)||void 0===t?void 0:t.velocity.y,null===(e=this.ball.body)||void 0===e?void 0:e.velocity.x);this.soundManager.playSound("net"),s+=1,this.ball.stateMachine.setState("idle",this.basketCtrl.getNext().x,this.basketCtrl.getNext().y,dt.getScoreManager().getCurScore()),this.basketCtrl.getNext().rotation- -i<=.15&&(s+=1,this.perfectText.emitTextFadeInOut(this.basketCtrl.getNext().x,this.basketCtrl.getNext().y-140,1e3)),1==this.flag.alpha&&(s+=1,this.flagText.emitTextFadeInOut(this.basketCtrl.getNext().x,this.basketCtrl.getNext().y-100,1e3),this.flag.setAlpha(0)),this.ball.isPowerUp()&&(s+=1),dt.getScoreManager().incrementScore(s),this.incScoreText.setText("+"+s.toString()),this.incScoreText.emitTextFadeInOut(this.basketCtrl.getNext().x,this.basketCtrl.getNext().y-65,1e3);const a=dt.getScoreManager().getCurScore();this.curScoreText.text=a.toString(),this.time.delayedCall(0,(()=>{this.basketCtrl.getNext().moveFollower(this.star),this.basketCtrl.getCur().moveFollower(this.ball),this.star.stateMachine.setState("enable")})),1==this.flag.alpha&&this.flag.setAlpha(0)}}}class H extends Phaser.Scene{constructor(){super({key:"PauseScene"})}create(){new T({scene:this,x:80,y:50,key:"settings",callback:()=>{dt.getSceneManager().stateMachine.setState("setting",this,{data:"pause"})},scale:.32}),new C({scene:this,x:625,y:50,key:"star",scale:.48}),new E({scene:this,x:675,y:50,msg:"0",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}),new E({scene:this,x:357.5,y:260,msg:"PAUSED",style:{fontSize:"100px",color:"#ababab",fontStyle:"bold"}}),new T({scene:this,x:357.5,y:390,key:"main-menu",callback:()=>{dt.getSceneManager().stateMachine.setState("start",this)},scale:.32}),new T({scene:this,x:357.5,y:540,key:"leader-board",callback:()=>{console.log("Leaderboard")},scale:.32}),new T({scene:this,x:357.5,y:740,key:"resume",callback:()=>{dt.getSceneManager().stateMachine.setState("resume",this)},scale:.36})}}class X extends Phaser.Scene{constructor(){super({key:"GameOverScene"})}updateLeaderboard(){let t="";try{this.firebase.getHighScores().then((e=>{e.forEach(((e,s)=>{t+=`\n${s+1}. ${e.name} ${e.score}`})),console.log(this.boardText,t),this.boardText&&t&&this.boardText.setText(t)}))}catch(t){console.log(t)}}create(t){this.boardText=new E({scene:this,x:357.5,y:620,msg:"Fetching...",style:{fontSize:"35px",color:"#e2224c"}}).setDepth(10),new C({scene:this,x:625,y:50,key:"star",scale:.48}),new E({scene:this,x:675,y:50,msg:dt.getScoreManager().getStars().toString(),style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}),new E({scene:this,x:357.5,y:70,msg:"BEST SCORE",style:{fontSize:"50px",color:"#ffa500",fontStyle:"bold"}});const e=new E({scene:this,x:357.5,y:160,msg:dt.getScoreManager().getBestScore().toString(),style:{fontSize:"90px",color:"#ffa500",fontStyle:"bold"}}).setAlpha(0),s=new E({scene:this,x:357.5,y:320,msg:"0",style:{fontSize:"180px",color:"#ababab",fontStyle:"bold"}});this.tweens.add({targets:{score:"0"},score:t.data.toString(),duration:1e3,ease:"Power1",onUpdate:function(t){s.text=Math.round(t.targets[0].score).toString()},onComplete:function(){e.setAlpha(1)}}),new T({scene:this,x:207.5,y:940,key:"ig",callback:()=>{window.location.href="https://www.facebook.com/khasang0412/"},scale:.4}),new T({scene:this,x:357.5,y:940,key:"return",callback:()=>{this.scene.start("PlayScene")},scale:.4}),new T({scene:this,x:507.5,y:940,key:"settings",callback:()=>{dt.getSceneManager().stateMachine.setState("setting",this,{data:"over"})},scale:.32}),this.updateLeaderboard()}}const z=document.getElementById("game");class V extends Phaser.Scene{constructor(){super({key:"SettingScene"})}create(t){new T({scene:this,x:50,y:45,key:"close",callback:()=>{dt.getSceneManager().stateMachine.setState(t.data,this)},scale:.4}),new E({scene:this,x:357.5,y:50,msg:"SETTINGS",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"#ababab"}}),new C({scene:this,x:625,y:50,key:"star",scale:.48}),new E({scene:this,x:675,y:50,msg:localStorage.getItem("star")||"0",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}),this.soundImgOn=new T({scene:this,x:357.5,y:540,key:"sound-on",callback:()=>{this.handleMuteSound()},scale:.2*1.5}).setAlpha(this.sound.mute?0:1),this.soundImgOff=new T({scene:this,x:357.5,y:540,key:"sound-off",callback:()=>{this.handleMuteSound()},scale:.2*1.5}).setAlpha(this.sound.mute?1:0),this.lightImgOn=new T({scene:this,x:357.5,y:420,key:"light-on",callback:()=>{this.handleToggleLight()},scale:.8}).setAlpha(z.style.backgroundColor==h?1:0),this.lightImgOff=new T({scene:this,x:357.5,y:420,key:"light-off",callback:()=>{this.handleToggleLight()},scale:.8}).setAlpha(z.style.backgroundColor==h?0:1)}handleMuteSound(){this.sound.mute?(this.sound.setMute(!1),this.soundImgOn.setAlpha(1),this.soundImgOff.setAlpha(0)):(this.sound.setMute(!0),this.soundImgOn.setAlpha(0),this.soundImgOff.setAlpha(1))}handleToggleLight(){z.style.backgroundColor===h?(z.style.backgroundColor="rgb(20, 24, 82)",this.lightImgOn.setAlpha(0),this.lightImgOff.setAlpha(1)):(z.style.backgroundColor=h,this.lightImgOn.setAlpha(1),this.lightImgOff.setAlpha(0))}}class W extends Phaser.Scene{constructor(){super({key:"CustomizeScene"}),this.lastPointer={x:0,y:0},null==localStorage.getItem("balls")&&(localStorage.setItem("balls",JSON.stringify([])),this.curBalls=[])}create(){this.curBalls=JSON.parse(localStorage.getItem("balls")),console.log(this.curBalls),this.cameras.main.setBounds(0,0,n,1900),this.input.on("pointermove",(t=>{t.isDown&&(this.cameras.main.scrollX+=this.lastPointer.x-t.x,this.cameras.main.scrollY+=this.lastPointer.y-t.y),this.lastPointer.x=t.x,this.lastPointer.y=t.y})),new E({scene:this,x:357.5,y:50,msg:"CHOOSE A BALL",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"#ababab"}}),new C({scene:this,x:625,y:50,key:"star",scale:.32}),this.starText=new E({scene:this,x:675,y:50,msg:localStorage.getItem("star"),style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}});const t=357.5;this.createBallButton(t,190,"ball_1",10),this.createBallButton(t,320,"ball_2",10),this.createBallButton(t,450,"ball_3",10),this.createBallButton(t,580,"ball_4",10),this.createBallButton(t,710,"ball_5",10),this.createBallButton(t,840,"ball_6",10),this.createBallButton(t,970,"ball_7",10),this.createBallButton(t,1100,"ball_8",10),this.createBallButton(t,1230,"ball_9",10),this.createBallButton(t,1360,"ball_10",10),this.createBallButton(t,1490,"ball_11",10),this.createBallButton(t,1620,"ball_12",10),this.createBallButton(t,1750,"ball_locked",10)}createBallButton(t,e,s,i){const a=new T({scene:this,x:t,y:e,key:s,callback:()=>{dt.getSceneManager().stateMachine.setState("start",this,{skin:s})},scale:.3});if(!this.curBalls.includes(s)){a.setAlpha(.5);const n=new T({scene:this,x:t,y:e,key:"lock",scale:.3*1.5,callback:()=>{this.purchase(s,i)&&(a.setAlpha(1),n.destroy())}})}}purchase(t,e){const s=parseInt(this.starText.text);return s>e&&(this.curBalls.push(t),this.starText.text=(s-e).toString(),localStorage.setItem("balls",JSON.stringify(this.curBalls)),localStorage.setItem("star",this.starText.text),!0)}}let K=0;class Q{constructor(t,e){this.states=new Map,this.id=(++K).toString(),this.isChangingState=!1,this.id=null!=e?e:this.id,this.context=t,this.changeStateQueue=[]}addState(t,e){var s,i,a;const n=this.context;return this.states.set(t,{name:t,onEnter:null===(s=null==e?void 0:e.onEnter)||void 0===s?void 0:s.bind(n),onUpdate:null===(i=null==e?void 0:e.onUpdate)||void 0===i?void 0:i.bind(n),onExit:null===(a=null==e?void 0:e.onExit)||void 0===a?void 0:a.bind(n)}),this}setState(t,e,s){var i,a,n;if(this.states.has(t)){if((null===(i=this.currentState)||void 0===i?void 0:i.name)!=t){if(this.isChangingState)return this.changeStateQueue.push(t),void console.log(`[StateMachine (${this.id})] change from ${null!==(n=null===(a=this.currentState)||void 0===a?void 0:a.name)&&void 0!==n?n:"none"} to ${t}`);this.isChangingState=!0,this.currentState&&this.currentState.onExit&&this.currentState.onExit(),this.currentState=this.states.get(t),this.currentState.onEnter&&(s?this.currentState.onEnter(e,s):this.currentState.onEnter(e)),this.isChangingState=!1}}else console.warn(`Tried to change to unknown state: ${t}`)}isCurrentState(t){return!!this.currentState&&this.currentState.name===t}update(t,e){this.changeStateQueue.length>0?this.setState(this.changeStateQueue.shift(),e):this.currentState&&this.currentState.onUpdate&&this.currentState.onUpdate(t)}}class ${constructor(){this.stateMachine=new Q(this,"scene"),this.stateMachine.addState("preload",{onEnter:this.onPreloadEnter}).addState("play",{onEnter:this.onPlayEnter}).addState("start",{onEnter:this.onStartEnter}).addState("over",{onEnter:this.onOverEnter}).addState("pause",{onEnter:this.onPauseEnter}).addState("resume",{onEnter:this.onResumeEnter}).addState("setting",{onEnter:this.onSettingEnter}).addState("customize",{onEnter:this.onCustomizeEnter}).addState("challenge",{onEnter:this.onChallengeEnter})}static getInstance(){return $.instance||($.instance=new $),$.instance}onPreloadEnter(t){}onPlayEnter(t,e){t.scene.start(l,e)}onChallengeEnter(t,e){t.scene.start("ChallengeScene",e)}onCustomizeEnter(t){t.scene.start("CustomizeScene")}onStartEnter(t,e){t.scene.start("StartScene",e)}onSettingEnter(t,e){t.scene.start("SettingScene",e)}onPauseEnter(t){t.scene.switch("PauseScene")}onResumeEnter(t){t.scene.switch(l)}onOverEnter(t,e){t.scene.start("GameOverScene",e)}}class J{constructor(){this.curScore=0,this.curStar=0,localStorage.getItem("star")?this.stars=parseInt(localStorage.getItem("star")):(localStorage.setItem("star","0"),this.stars=0),localStorage.getItem("high-score")?this.bestScore=parseInt(localStorage.getItem("high-score")):(localStorage.setItem("high-score","0"),this.bestScore=0)}static getInstance(){return J.instance||(J.instance=new J),J.instance}reset(){this.curScore=0,this.curStar=0}getCurScore(){return this.curScore}getBestScore(){return this.bestScore}getCurStar(){return this.curStar}getStars(){return this.stars}incrementScore(t){this.curScore+=t}incrementStar(){this.curStar++}saveScoreToLocalStorage(){this.bestScore=Math.max(this.bestScore,this.curScore),this.stars+=this.curStar,localStorage.setItem("high-score",this.bestScore.toString()),localStorage.setItem("star",this.stars.toString())}}class q{constructor(){this.sceneManager=$.getInstance(),this.scoreManager=J.getInstance(),this.inputManager=I.getInstance(),this.soundManager=A.getInstance()}static getInstance(){return q.instance||(q.instance=new q),q.instance}getScoreManager(){return this.scoreManager}getSceneManager(){return this.sceneManager}getInputManager(){return this.inputManager}}var Z=s(977),tt=s(953),et=s(155),st=function(t,e,s,i){return new(s||(s=Promise))((function(a,n){function o(t){try{r(i.next(t))}catch(t){n(t)}}function h(t){try{r(i.throw(t))}catch(t){n(t)}}function r(t){var e;t.done?a(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,h)}r((i=i.apply(t,e||[])).next())}))};const it={apiKey:"AIzaSyAF_Wawq4by-Rza3On2GbHV4TpyV2jyibg",authDomain:"dunk-shot-phaser.firebaseapp.com",projectId:"dunk-shot-phaser",storageBucket:"dunk-shot-phaser.appspot.com",messagingSenderId:"275371751196",appId:"1:275371751196:web:b2c651cdcc12ee3c282cd9",measurementId:"G-Y9XG2WQM39"};class at extends a().Plugins.BasePlugin{constructor(t){super(t);const e=(0,Z.ZF)(it);this.db=(0,tt.ad)(e),this.auth=(0,et.v0)(e),this.authStateChangedUnsubscribed=(0,et.Aj)(this.auth,(t=>{t&&this.onLoggedInCallback&&this.onLoggedInCallback()}))}saveGameData(t,e){return st(this,void 0,void 0,(function*(){yield(0,tt.pl)((0,tt.JU)(this.db,"game-data",t),e)}))}loadGameData(t){return st(this,void 0,void 0,(function*(){return(yield(0,tt.QT)((0,tt.JU)(this.db,"game-data",t))).data()}))}createUserWithEmail(t,e){return st(this,void 0,void 0,(function*(){return(yield(0,et.Xb)(this.auth,t,e)).user}))}signInUserWithEmail(t,e){return st(this,void 0,void 0,(function*(){return(yield(0,et.e5)(this.auth,t,e)).user}))}signInAnonymously(){return st(this,void 0,void 0,(function*(){yield(0,et.XB)(this.auth)}))}signInWithPopup(){return st(this,void 0,void 0,(function*(){const t=new et.hJ,e=(0,et.v0)();(0,et.rh)(e,t,et.n0).then((t=>t.user)).catch((t=>{console.log(t)}))}))}destroy(){this.authStateChangedUnsubscribed(),super.destroy()}onLoggedIn(t){this.onLoggedInCallback=t}getUser(){return this.auth.currentUser}addHighScore(t,e){return st(this,void 0,void 0,(function*(){yield(0,tt.ET)((0,tt.hJ)(this.db,"high-scores"),{name:t,score:e})}))}getHighScores(){return st(this,void 0,void 0,(function*(){const t=(0,tt.IO)((0,tt.hJ)(this.db,"high-scores"),(0,tt.Xo)("score","desc"),(0,tt.b9)(10));return(yield(0,tt.PL)(t)).docs.map((t=>t.data()))}))}}class nt extends Phaser.Physics.Arcade.Sprite{constructor(t){super(t.scene,t.x,t.y,t.key),this.setOrigin(.5,.5),this.scale=t.scale?t.scale:1,this.setScale(t.scale),this.body=this.body}}class ot extends nt{constructor(t){var e;super(t),this.scene.physics.add.existing(this),this.setOrigin(.5,.5),this.setGravity(0,0),null===(e=this.body)||void 0===e||e.setCircle(this.width/2+5),this.setScale(.15),this.setImmovable(!0),this.setPushable(!1),this.scene.add.existing(this),this.setBounce(1,1),this.isVibrating=!1}update(){this.setVelocity(0,0)}getIsVibrating(){return this.isVibrating}onNotify(t){}vibrate(){this.isVibrating=!0,this.scene.tweens.add({targets:this,y:this.y-10,duration:20,ease:"Linear",yoyo:!0,repeat:3,onComplete:()=>{this.isVibrating=!1}})}}class ht extends Phaser.Scene{constructor(){super({key:"ChallengeScene"}),this.basketCtrl=new D}createMap(){this.map=this.make.tilemap({key:this.registry.get("level")}),this.tileset=this.map.addTilesetImage("tiles"),this.background=this.map.createLayer("background",this.tileset,0,0),this.background.setName("background"),this.animatedTiles.init(this.map)}createAssets(){const[t,e]=[n,o];this.fps=new Y(this),this.pauseImg=new T({scene:this,x:80,y:50,key:"pause",callback:()=>{dt.getSceneManager().stateMachine.setState("pause",this)},scale:.12}),this.levelText=new E({scene:this,x:t-100,y:50,msg:"0",style:{fontFamily:"MilkyHoney",fontSize:"45px",color:"black",strokeThickness:3}}).setDepth(1),this.bounceText=new E({scene:this,x:-100,y:-100,msg:"PERFECT !!",style:{fontSize:"30px",color:"#ffa500",fontStyle:"bold"}}),this.incScoreText=new E({scene:this,x:-100,y:-100,msg:"+1",style:{fontSize:"50px",color:"red",fontStyle:"bold"}})}createObjects(t){var e;this.bouncingBalls=this.add.group({runChildUpdate:!0});const s=new R({scene:this,x:357.5,y:840,key:"basket",callback:(t,e,s,i)=>{this.ball.stateMachine.setState("fly",t,e,s,i)},scale:.65}).setDepth(2).setMaxVelocity(0,0),i=new R({scene:this,x:575,y:340,key:"basket",callback:(t,e,s,i)=>{this.ball.stateMachine.setState("fly",t,e,s,i)},scale:.65}).setDepth(2).setMaxVelocity(0,0);this.basketCtrl.setCur(s),this.basketCtrl.setNext(i),this.ball=new M({scene:this,x:125,y:740,key:"ball",scale:.12}).setDepth(1),t&&this.ball.setTexture(t.skin),this.physics.world.setFPS(60),(null===(e=this.map.getObjectLayer("objects"))||void 0===e?void 0:e.objects).forEach((t=>{"ball"===t.type&&this.bouncingBalls.add(new ot({scene:this,x:t.x,y:t.y,key:"ball_2"}).setName(t.name)),"shooting_ball"===t.type&&(this.ball.setX(t.x),this.ball.setY(t.y)),"basket"===t.type&&("curBasket"===t.name?(this.basketCtrl.getCur().setPosition(t.x,t.y),this.basketCtrl.getCur().updateBody()):(this.basketCtrl.getNext().setPosition(t.x,t.y),this.basketCtrl.getNext().updateBody(),this.nextLevel=t.properties[0].value))}))}subscribe(){this.input.on("pointerdown",this.inputManager.onPointerDown,this.inputManager),this.input.on("pointermove",this.onPointerMove,this),this.input.on("pointerup",this.onPointerUp,this),this.eventManager.subscribe(this),this.eventManager.subscribe(this.ball),this.eventManager.subscribe(this.basketCtrl),this.physics.add.collider(this.ball,this.foreground),this.physics.add.collider(this.ball,this.bouncingBalls,((t,e)=>{const s=e;s.getIsVibrating()||s.vibrate()}))}create(t){dt.getScoreManager().reset(),this.eventManager=new O,this.inputManager=I.getInstance(),this.soundManager=A.getInstance(),this.soundManager.addSound("net",this.sound.add("net")),this.soundManager.addSound("shoot",this.sound.add("shoot")),this.soundManager.addSound("click",this.sound.add("click")),this.soundManager.addSound("over",this.sound.add("game-over")),this.createMap(),this.createObjects(t),this.createAssets(),this.subscribe(),this.cameras.main.startFollow(this.ball,!1,0,.1,20,450),this.levelText.setText(this.registry.get("level").toUpperCase())}onPointerUp(t){this.inputManager.isDragging()&&!this.ball.isFlying()&&(this.basketCtrl.getCur().stateMachine.setState("idle"),this.ball.stateMachine.setState("fly",this.basketCtrl.getCur().x,this.basketCtrl.getCur().y),this.inputManager.emitDragLeave(),this.soundManager.playSound("shoot"))}onPointerMove(t){if(t.isDown&&this.inputManager.isDragging()&&!this.ball.isFlying()){const[e,s]=this.inputManager.estimateVelocityAndAngle(t);this.basketCtrl.getCur().stateMachine.setState("snipe",e,s),this.ball.stateMachine.setState("snipe",e,Math.PI/2-this.basketCtrl.getCur().rotation)}}update(t,e){this.sys.isActive()?(this.ball.update(e),this.updateBackground(),this.ball.y>this.basketCtrl.getCur().y+200&&this.eventManager.notify(c.LOWER_BOUND),this.basketCtrl.getCur().y-this.ball.y>540&&this.eventManager.notify(c.UPPER_BOUND),this.ball.isFlyingDown()&&this.physics.collide(this.ball,this.basketCtrl.getCur().bodyGroup)&&this.eventManager.notify(c.CURRENT_BASKET),this.physics.overlap(this.ball,this.basketCtrl.getNext().openGroup)&&this.physics.overlap(this.ball,this.basketCtrl.getNext().bodyGroup)&&this.eventManager.notify(c.NEXT_BASKET),this.physics.collide(this.ball,this.basketCtrl.getNext().bodyGroup)&&this.eventManager.notify(c.OBSTACLE),this.ball.isOutOfBounds()&&this.eventManager.notify(c.WALL),this.animatedTiles.updateAnimatedTiles()):console.log("not active yet")}updateBackground(){const t=this.cameras.main.scrollY;this.fps.update(),this.pauseImg.setY(t+50),this.fps.setY(t+50),this.levelText.setY(t+50),this.background.setY(t-30)}onNotify(t){switch(t){case c.LOWER_BOUND:this.onHitLowerBound();break;case c.CURRENT_BASKET:this.onHitCurrent();break;case c.NEXT_BASKET:this.onHitNext()}}onHitLowerBound(){if(this.soundManager.playSound("over"),0==dt.getScoreManager().getCurScore())return this.ball.setPosition(this.basketCtrl.getCur().x,this.basketCtrl.getCur().y-20),void this.ball.stateMachine.setState("idle",this.basketCtrl.getCur().x,this.basketCtrl.getCur().y);dt.getScoreManager().saveScoreToLocalStorage(),this.firebase.addHighScore(this.firebase.getUser()?this.firebase.getUser().displayName:"test",dt.getScoreManager().getCurScore()),this.scene.start("GameOverScene",{data:dt.getScoreManager().getCurScore()})}onHitCurrent(){this.ball.stateMachine.setState("idle",this.basketCtrl.getCur().x,this.basketCtrl.getCur().y),this.soundManager.playSound("net")}onHitNext(){var t,e;if(this.ball.body){let s=0;const i=Math.atan2(null===(t=this.ball.body)||void 0===t?void 0:t.velocity.y,null===(e=this.ball.body)||void 0===e?void 0:e.velocity.x);this.soundManager.playSound("net"),s+=1,this.ball.stateMachine.setState("idle",this.basketCtrl.getNext().x,this.basketCtrl.getNext().y,dt.getScoreManager().getCurScore()),this.basketCtrl.getNext().rotation- -i<=.15&&(s+=1,this.bounceText.emitTextFadeInOut(this.basketCtrl.getNext().x,this.basketCtrl.getNext().y-140,1e3)),this.ball.isPowerUp()&&(s+=1),dt.getScoreManager().incrementScore(s),this.incScoreText.setText("+"+s.toString()),this.incScoreText.emitTextFadeInOut(this.basketCtrl.getNext().x,this.basketCtrl.getNext().y-65,1e3),""!=this.nextLevel?(this.registry.set("level",this.nextLevel),this.nextLevel="",this.scene.restart()):dt.getSceneManager().stateMachine.setState("start",this)}}}const rt=t=>"animation"in t;class lt extends a().Plugins.ScenePlugin{constructor(t,e,s){super(t,e,s),this.animatedTiles=[],this.activeLayer=[],this.followTimeScale=!0,this.active=!1,this.rate=1}boot(){var t;const e=null===(t=this.systems)||void 0===t?void 0:t.events;null==e||e.on("postupdate",this.postUpdate,this),null==e||e.on("shutdown",this.shutdown,this),null==e||e.on("destroy",this.destroy,this)}shutdown(){this.animatedTiles.length=0}destroy(){this.shutdown(),this.scene=void 0}init(t){const e={map:t,animatedTiles:this.getAnimatedTiles(t),active:!0,rate:1,activeLayer:[]};e.activeLayer=t.layers.map((()=>!0)),this.animatedTiles.push(e),1===this.animatedTiles.length&&(this.active=!0)}start(){}stop(){}postUpdate(t,e){if(!this.active)return;const s=e*this.rate*(this.followTimeScale&&this.scene?this.scene.time.timeScale:1);for(const t of this.animatedTiles){if(!t.active)continue;const e=s*t.rate;for(const s of t.animatedTiles)if(s.next-=e*s.rate,s.next<0){const e=s.currentFrame,i=s.frames[e]?s.frames[e].tileid:0;let a=e+1;a>s.frames.length-1&&(a=0),s.next=s.frames[a].duration,s.currentFrame=a;for(const[e,a]of s.tiles.entries())t.activeLayer[e]&&this.updateLayer(s,a,i)}}}updateLayer(t,e,s=-1){const i=[],a=t.frames[t.currentFrame].tileid;for(const t of e)s>-1&&(null==t?void 0:t.index)!==s?i.push(t):t.index=a;for(const t of i){const s=e.indexOf(t);s>-1?e.splice(s,1):console.error("This shouldn't happen. Not at all. Blame Phaser Animated Tiles plugin. You'll be fine though.")}}getAnimatedTiles(t){var e,s;const i=[];for(const a of t.tilesets){const n=a.tileData;for(const[o,h]of Object.entries(n)){const n=parseInt(o);if(!rt(h))continue;const r={index:n+a.firstgid,frames:[],currentFrame:0,tiles:[],rate:1,next:0};for(const t of h.animation){const e={duration:t.duration,tileid:t.tileid+a.firstgid};r.frames.push(e)}r.next=null!==(s=null===(e=r.frames[0])||void 0===e?void 0:e.duration)&&void 0!==s?s:0,r.currentFrame=r.frames.findIndex((t=>t.tileid===n+a.firstgid));for(const e of t.layers){const t=[];for(const s of e.data)for(const e of s)e.index-a.firstgid===n&&t.push(e);r.tiles.push(t)}i.push(r)}}for(const[e]of t.layers.entries())this.activeLayer[e]=!0;return i}updateAnimatedTiles(){var t,e;const s=this.animatedTiles;for(const i of s){const s=0,a=0,n=null!==(t=i.map.width)&&void 0!==t?t:10,o=null!==(e=i.map.height)&&void 0!==e?e:10;for(const t of i.animatedTiles)for(const[e,h]of t.tiles.entries())for(let r=s;r<s+n;r++)for(let s=a;s<a+o;s++){const a=i.map.layers[e].data[r][s];a&&a.index==t.index&&(-1===h.indexOf(a)&&h.push(a),a.index=t.frames[t.currentFrame].tileid)}}}}lt.key="AnimatedTiles",lt.mapping="animatedTiles";const ct={type:Phaser.AUTO,parent:"game",transparent:!0,canvasStyle:"border-left: 2px solid black; border-right: 2px solid black",scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:n,height:o},scene:[d,B,j,H,X,V,W,ht],physics:{default:"arcade",arcade:{debug:!1,fps:60},fps:{target:60,forceSetTimeOut:!0}},plugins:{global:[{key:"FirebasePlugin",plugin:at,start:!0,mapping:"firebase"}],scene:[{key:lt.key,plugin:lt,mapping:lt.mapping,start:!0}]}};window.addEventListener("load",(()=>{new Phaser.Game(ct)}));const dt=q.getInstance()}},s={};function i(t){var a=s[t];if(void 0!==a)return a.exports;var n=s[t]={exports:{}};return e[t].call(n.exports,n,n.exports,i),n.exports}i.m=e,t=[],i.O=(e,s,a,n)=>{if(!s){var o=1/0;for(c=0;c<t.length;c++){for(var[s,a,n]=t[c],h=!0,r=0;r<s.length;r++)(!1&n||o>=n)&&Object.keys(i.O).every((t=>i.O[t](s[r])))?s.splice(r--,1):(h=!1,n<o&&(o=n));if(h){t.splice(c--,1);var l=a();void 0!==l&&(e=l)}}return e}n=n||0;for(var c=t.length;c>0&&t[c-1][2]>n;c--)t[c]=t[c-1];t[c]=[s,a,n]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var a,n,[o,h,r]=s,l=0;if(o.some((e=>0!==t[e]))){for(a in h)i.o(h,a)&&(i.m[a]=h[a]);if(r)var c=r(i)}for(e&&e(s);l<o.length;l++)n=o[l],i.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return i.O(c)},s=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var a=i.O(void 0,[216],(()=>i(256)));a=i.O(a)})();